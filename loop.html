<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capitolo 14 Programmazione Iterativa | Introduction to R</title>
  <meta name="description" content="Questo è un libro intorduttivo ad R prodotto da Psicostat, gruppo di ricerca interdisciplinare che unisce la passione per la statistica e la psicologia." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Capitolo 14 Programmazione Iterativa | Introduction to R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://psicostat.github.io/Introduction2R/" />
  <meta property="og:image" content="https://psicostat.github.io/Introduction2R/images/logo_psicostat.png" />
  <meta property="og:description" content="Questo è un libro intorduttivo ad R prodotto da Psicostat, gruppo di ricerca interdisciplinare che unisce la passione per la statistica e la psicologia." />
  <meta name="github-repo" content="psicostat/Introduction2R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capitolo 14 Programmazione Iterativa | Introduction to R" />
  
  <meta name="twitter:description" content="Questo è un libro intorduttivo ad R prodotto da Psicostat, gruppo di ricerca interdisciplinare che unisce la passione per la statistica e la psicologia." />
  <meta name="twitter:image" content="https://psicostat.github.io/Introduction2R/images/logo_psicostat.png" />

<meta name="author" content="Claudio Zandonella Callegher and Filippo Gambarota members of Psicostat" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="conditionals.html"/>
<link rel="next" href="introduzione-1.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RM7HE6D2VW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-RM7HE6D2VW');
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
<link rel="stylesheet" href="assets/toc.css" type="text/css" />
<link rel="stylesheet" href="assets/custom.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="images/hex_psicostat.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Presentazione</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#perchè-r"><i class="fa fa-check"></i>Perchè R</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#struttura-del-libro"><i class="fa fa-check"></i>Struttura del libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#risorse-utili"><i class="fa fa-check"></i>Risorse Utili</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#psicostat"><i class="fa fa-check"></i>Psicostat</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#collaborazione"><i class="fa fa-check"></i>Collaborazione</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#riconoscimenti"><i class="fa fa-check"></i>Riconoscimenti</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#licenza"><i class="fa fa-check"></i>Licenza</a></li>
</ul></li>
<li class="part"><span><b>Get Started</b></span></li>
<li class="chapter" data-level="" data-path="introduzione.html"><a href="introduzione.html"><i class="fa fa-check"></i>Introduzione</a></li>
<li class="chapter" data-level="1" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i><b>1</b> Installare R e RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="install.html"><a href="install.html#install-r"><i class="fa fa-check"></i><b>1.1</b> Installare R</a><ul>
<li class="chapter" data-level="1.1.1" data-path="install.html"><a href="install.html#r-windows"><i class="fa fa-check"></i><b>1.1.1</b> R Windows</a></li>
<li class="chapter" data-level="1.1.2" data-path="install.html"><a href="install.html#r-macos"><i class="fa fa-check"></i><b>1.1.2</b> R MacOS</a></li>
<li class="chapter" data-level="1.1.3" data-path="install.html"><a href="install.html#r-linux"><i class="fa fa-check"></i><b>1.1.3</b> R Linux</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="install.html"><a href="install.html#installare-r-studio"><i class="fa fa-check"></i><b>1.2</b> Installare R Studio</a><ul>
<li class="chapter" data-level="1.2.1" data-path="install.html"><a href="install.html#r-studio-in-linux"><i class="fa fa-check"></i><b>1.2.1</b> R Studio in Linux</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rstudio-gui.html"><a href="rstudio-gui.html"><i class="fa fa-check"></i><b>2</b> Interfaccia RStudio</a></li>
<li class="chapter" data-level="3" data-path="first-comands.html"><a href="first-comands.html"><i class="fa fa-check"></i><b>3</b> Primi Passi in R</a><ul>
<li class="chapter" data-level="3.1" data-path="first-comands.html"><a href="first-comands.html#math-operators"><i class="fa fa-check"></i><b>3.1</b> Operatori Matematici</a><ul>
<li class="chapter" data-level="3.1.1" data-path="first-comands.html"><a href="first-comands.html#ordine-operazioni"><i class="fa fa-check"></i><b>3.1.1</b> Ordine Operazioni</a></li>
<li class="chapter" data-level="" data-path="first-comands.html"><a href="first-comands.html#esercizi"><i class="fa fa-check"></i>Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="first-comands.html"><a href="first-comands.html#operators-rel-log"><i class="fa fa-check"></i><b>3.2</b> Operatori Relazionali e Logici</a><ul>
<li class="chapter" data-level="3.2.1" data-path="first-comands.html"><a href="first-comands.html#operatori-relazionali"><i class="fa fa-check"></i><b>3.2.1</b> Operatori Relazionali</a></li>
<li class="chapter" data-level="3.2.2" data-path="first-comands.html"><a href="first-comands.html#operatori-logici"><i class="fa fa-check"></i><b>3.2.2</b> Operatori Logici</a></li>
<li class="chapter" data-level="3.2.3" data-path="first-comands.html"><a href="first-comands.html#ordine-valutazione-relazioni"><i class="fa fa-check"></i><b>3.2.3</b> Ordine valutazione relazioni</a></li>
<li class="chapter" data-level="" data-path="first-comands.html"><a href="first-comands.html#esercizi-1"><i class="fa fa-check"></i>Esercizi</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="objects-functions.html"><a href="objects-functions.html"><i class="fa fa-check"></i><b>4</b> Due Compagni Inseparabili</a><ul>
<li class="chapter" data-level="4.1" data-path="objects-functions.html"><a href="objects-functions.html#objects-section"><i class="fa fa-check"></i><b>4.1</b> Oggetti</a><ul>
<li class="chapter" data-level="4.1.1" data-path="objects-functions.html"><a href="objects-functions.html#assign"><i class="fa fa-check"></i><b>4.1.1</b> Assegnare e Richiamare un oggetto</a></li>
<li class="chapter" data-level="4.1.2" data-path="objects-functions.html"><a href="objects-functions.html#objects-names"><i class="fa fa-check"></i><b>4.1.2</b> Nomi degli oggetti</a></li>
<li class="chapter" data-level="4.1.3" data-path="objects-functions.html"><a href="objects-functions.html#tipologie-dati-e-strutture-dati"><i class="fa fa-check"></i><b>4.1.3</b> Tipologie Dati e Strutture Dati</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="objects-functions.html"><a href="objects-functions.html#functions-def"><i class="fa fa-check"></i><b>4.2</b> Funzioni</a><ul>
<li class="chapter" data-level="4.2.1" data-path="objects-functions.html"><a href="objects-functions.html#function-arguments"><i class="fa fa-check"></i><b>4.2.1</b> Argomenti di una Funzione</a></li>
<li class="chapter" data-level="4.2.2" data-path="objects-functions.html"><a href="objects-functions.html#help"><i class="fa fa-check"></i><b>4.2.2</b> Help! I need Somebody…Help!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="working-environment.html"><a href="working-environment.html"><i class="fa fa-check"></i><b>5</b> Ambiente di Lavoro</a><ul>
<li class="chapter" data-level="5.1" data-path="working-environment.html"><a href="working-environment.html#environment"><i class="fa fa-check"></i><b>5.1</b> Environment</a><ul>
<li class="chapter" data-level="5.1.1" data-path="working-environment.html"><a href="working-environment.html#aggiungere-oggetti-allenvironment"><i class="fa fa-check"></i><b>5.1.1</b> Aggiungere Oggetti all’Environment</a></li>
<li class="chapter" data-level="5.1.2" data-path="working-environment.html"><a href="working-environment.html#rimuovere-oggetti-dallenvironment"><i class="fa fa-check"></i><b>5.1.2</b> Rimuovere Oggetti dall’Environment</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="working-environment.html"><a href="working-environment.html#working-directory"><i class="fa fa-check"></i><b>5.2</b> Working Directory</a><ul>
<li class="chapter" data-level="5.2.1" data-path="working-environment.html"><a href="working-environment.html#organizzazione-computer"><i class="fa fa-check"></i><b>5.2.1</b> Organizzazione Computer</a></li>
<li class="chapter" data-level="5.2.2" data-path="working-environment.html"><a href="working-environment.html#absolute-path-e-relative-path"><i class="fa fa-check"></i><b>5.2.2</b> Absolute Path e Relative Path</a></li>
<li class="chapter" data-level="5.2.3" data-path="working-environment.html"><a href="working-environment.html#working-directory-in-r"><i class="fa fa-check"></i><b>5.2.3</b> Working Directory in R</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="working-environment.html"><a href="working-environment.html#packages"><i class="fa fa-check"></i><b>5.3</b> R-packages</a><ul>
<li class="chapter" data-level="5.3.1" data-path="working-environment.html"><a href="working-environment.html#install.packages"><i class="fa fa-check"></i><b>5.3.1</b> install.packages()</a></li>
<li class="chapter" data-level="5.3.2" data-path="working-environment.html"><a href="working-environment.html#library"><i class="fa fa-check"></i><b>5.3.2</b> library()</a></li>
<li class="chapter" data-level="5.3.3" data-path="working-environment.html"><a href="working-environment.html#aggiornare-e-rimuovere-pacchetti"><i class="fa fa-check"></i><b>5.3.3</b> Aggiornare e Rimuovere Pacchetti</a></li>
<li class="chapter" data-level="5.3.4" data-path="working-environment.html"><a href="working-environment.html#documentazione-pacchetti"><i class="fa fa-check"></i><b>5.3.4</b> Documentazione Pacchetti</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="working-session.html"><a href="working-session.html"><i class="fa fa-check"></i><b>6</b> Sessione di Lavoro</a><ul>
<li class="chapter" data-level="6.1" data-path="working-session.html"><a href="working-session.html#organizzazione-script"><i class="fa fa-check"></i><b>6.1</b> Organizzazione Script</a><ul>
<li class="chapter" data-level="6.1.1" data-path="working-session.html"><a href="working-session.html#creare-delle-sezioni"><i class="fa fa-check"></i><b>6.1.1</b> Creare delle Sezioni</a></li>
<li class="chapter" data-level="6.1.2" data-path="working-session.html"><a href="working-session.html#sintax"><i class="fa fa-check"></i><b>6.1.2</b> Sintassi</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="working-session.html"><a href="working-session.html#organizzazione-progetti"><i class="fa fa-check"></i><b>6.2</b> Organizzazione Progetti</a><ul>
<li class="chapter" data-level="6.2.1" data-path="working-session.html"><a href="working-session.html#rstudio-projects"><i class="fa fa-check"></i><b>6.2.1</b> RStudio Projects</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="working-session.html"><a href="working-session.html#messages-warnings-e-errors"><i class="fa fa-check"></i><b>6.3</b> Messages, Warnings e Errors</a><ul>
<li class="chapter" data-level="6.3.1" data-path="working-session.html"><a href="working-session.html#risolvere-gli-errori"><i class="fa fa-check"></i><b>6.3.1</b> Risolvere gli Errori</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Struttura Dati</b></span></li>
<li class="chapter" data-level="" data-path="second-section.html"><a href="second-section.html"><i class="fa fa-check"></i>Introduzione</a></li>
<li class="chapter" data-level="7" data-path="vector.html"><a href="vector.html"><i class="fa fa-check"></i><b>7</b> Vettori</a><ul>
<li class="chapter" data-level="7.1" data-path="vector.html"><a href="vector.html#creazione"><i class="fa fa-check"></i><b>7.1</b> Creazione</a><ul>
<li class="chapter" data-level="" data-path="vector.html"><a href="vector.html#esercizi-2"><i class="fa fa-check"></i>Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="vector.html"><a href="vector.html#vector-selection"><i class="fa fa-check"></i><b>7.2</b> Selezione Elementi</a><ul>
<li class="chapter" data-level="7.2.1" data-path="vector.html"><a href="vector.html#vector-selection-advanced"><i class="fa fa-check"></i><b>7.2.1</b> Utilizzi Avanzati Selezione</a></li>
<li class="chapter" data-level="" data-path="vector.html"><a href="vector.html#esercizi-3"><i class="fa fa-check"></i>Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="vector.html"><a href="vector.html#vector-functions"><i class="fa fa-check"></i><b>7.3</b> Funzioni ed Operazioni</a><ul>
<li class="chapter" data-level="" data-path="vector.html"><a href="vector.html#esercizi-4"><i class="fa fa-check"></i>Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="vector.html"><a href="vector.html#data-type"><i class="fa fa-check"></i><b>7.4</b> Data Type</a><ul>
<li class="chapter" data-level="7.4.1" data-path="vector.html"><a href="vector.html#character"><i class="fa fa-check"></i><b>7.4.1</b> Character</a></li>
<li class="chapter" data-level="7.4.2" data-path="vector.html"><a href="vector.html#numeric"><i class="fa fa-check"></i><b>7.4.2</b> Numeric</a></li>
<li class="chapter" data-level="7.4.3" data-path="vector.html"><a href="vector.html#integer"><i class="fa fa-check"></i><b>7.4.3</b> Integer</a></li>
<li class="chapter" data-level="7.4.4" data-path="vector.html"><a href="vector.html#logical-vector"><i class="fa fa-check"></i><b>7.4.4</b> Logical</a></li>
<li class="chapter" data-level="7.4.5" data-path="vector.html"><a href="vector.html#valori-speciali"><i class="fa fa-check"></i><b>7.4.5</b> Valori speciali</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="factor.html"><a href="factor.html"><i class="fa fa-check"></i><b>8</b> Fattori</a><ul>
<li class="chapter" data-level="8.1" data-path="factor.html"><a href="factor.html#attributes"><i class="fa fa-check"></i><b>8.1</b> Attributi di un Oggetto</a><ul>
<li class="chapter" data-level="8.1.1" data-path="factor.html"><a href="factor.html#attributi-di-un-vettore"><i class="fa fa-check"></i><b>8.1.1</b> Attributi di un Vettore</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="factor.html"><a href="factor.html#fattori"><i class="fa fa-check"></i><b>8.2</b> Fattori</a><ul>
<li class="chapter" data-level="8.2.1" data-path="factor.html"><a href="factor.html#funzionamento-fatori"><i class="fa fa-check"></i><b>8.2.1</b> Funzionamento Fatori</a></li>
<li class="chapter" data-level="8.2.2" data-path="factor.html"><a href="factor.html#operazioni-fattori"><i class="fa fa-check"></i><b>8.2.2</b> Operazioni Fattori</a></li>
<li class="chapter" data-level="8.2.3" data-path="factor.html"><a href="factor.html#fattori-ordinali"><i class="fa fa-check"></i><b>8.2.3</b> Fattori Ordinali</a></li>
<li class="chapter" data-level="" data-path="factor.html"><a href="factor.html#esercizi-5"><i class="fa fa-check"></i>Esercizi</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="matrix.html"><a href="matrix.html"><i class="fa fa-check"></i><b>9</b> Matrici</a><ul>
<li class="chapter" data-level="9.1" data-path="matrix.html"><a href="matrix.html#creazione-1"><i class="fa fa-check"></i><b>9.1</b> Creazione</a><ul>
<li class="chapter" data-level="9.1.1" data-path="matrix.html"><a href="matrix.html#matrix-types"><i class="fa fa-check"></i><b>9.1.1</b> Tipologie di Matrici</a></li>
<li class="chapter" data-level="" data-path="matrix.html"><a href="matrix.html#esercizi-6"><i class="fa fa-check"></i>Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="matrix.html"><a href="matrix.html#sel-matrix"><i class="fa fa-check"></i><b>9.2</b> Selezione Elementi</a><ul>
<li class="chapter" data-level="9.2.1" data-path="matrix.html"><a href="matrix.html#matrix-selection-advanced"><i class="fa fa-check"></i><b>9.2.1</b> Utilizzi Avanzati Selezione</a></li>
<li class="chapter" data-level="" data-path="matrix.html"><a href="matrix.html#esercizi-7"><i class="fa fa-check"></i>Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="matrix.html"><a href="matrix.html#funzioni-ed-operazioni"><i class="fa fa-check"></i><b>9.3</b> Funzioni ed Operazioni</a><ul>
<li class="chapter" data-level="9.3.1" data-path="matrix.html"><a href="matrix.html#mat-prop"><i class="fa fa-check"></i><b>9.3.1</b> Attributi di una Matrice</a></li>
<li class="chapter" data-level="9.3.2" data-path="matrix.html"><a href="matrix.html#matrix-bind"><i class="fa fa-check"></i><b>9.3.2</b> Unire Matrici</a></li>
<li class="chapter" data-level="9.3.3" data-path="matrix.html"><a href="matrix.html#operatori-matematici"><i class="fa fa-check"></i><b>9.3.3</b> Operatori Matematici</a></li>
<li class="chapter" data-level="" data-path="matrix.html"><a href="matrix.html#esercizi-8"><i class="fa fa-check"></i>Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="matrix.html"><a href="matrix.html#array"><i class="fa fa-check"></i><b>9.4</b> Array</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dataframe.html"><a href="dataframe.html"><i class="fa fa-check"></i><b>10</b> Dataframe</a><ul>
<li class="chapter" data-level="10.1" data-path="dataframe.html"><a href="dataframe.html#creazione-di-un-dataframe"><i class="fa fa-check"></i><b>10.1</b> Creazione di un dataframe</a><ul>
<li class="chapter" data-level="" data-path="dataframe.html"><a href="dataframe.html#esercizi-9"><i class="fa fa-check"></i>Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="dataframe.html"><a href="dataframe.html#sel-df"><i class="fa fa-check"></i><b>10.2</b> Selezione Elementi</a><ul>
<li class="chapter" data-level="10.2.1" data-path="dataframe.html"><a href="dataframe.html#utilizzi-avanzati-selezione"><i class="fa fa-check"></i><b>10.2.1</b> Utilizzi Avanzati Selezione</a></li>
<li class="chapter" data-level="" data-path="dataframe.html"><a href="dataframe.html#esercizi-10"><i class="fa fa-check"></i>Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="dataframe.html"><a href="dataframe.html#funzioni-ed-operazioni-1"><i class="fa fa-check"></i><b>10.3</b> Funzioni ed Operazioni</a><ul>
<li class="chapter" data-level="10.3.1" data-path="dataframe.html"><a href="dataframe.html#attributi-di-un-dataframe"><i class="fa fa-check"></i><b>10.3.1</b> Attributi di un Dataframe</a></li>
<li class="chapter" data-level="10.3.2" data-path="dataframe.html"><a href="dataframe.html#unire-dataframe"><i class="fa fa-check"></i><b>10.3.2</b> Unire Dataframe</a></li>
<li class="chapter" data-level="10.3.3" data-path="dataframe.html"><a href="dataframe.html#informazioni-dataframe"><i class="fa fa-check"></i><b>10.3.3</b> Informazioni Dataframe</a></li>
<li class="chapter" data-level="" data-path="dataframe.html"><a href="dataframe.html#esercizi-11"><i class="fa fa-check"></i>Esercizi</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="list.html"><a href="list.html"><i class="fa fa-check"></i><b>11</b> Liste</a><ul>
<li class="chapter" data-level="11.1" data-path="list.html"><a href="list.html#creazione-di-liste"><i class="fa fa-check"></i><b>11.1</b> Creazione di Liste</a><ul>
<li class="chapter" data-level="" data-path="list.html"><a href="list.html#esercizi-12"><i class="fa fa-check"></i>Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="list.html"><a href="list.html#selezione-elementi"><i class="fa fa-check"></i><b>11.2</b> Selezione Elementi</a><ul>
<li class="chapter" data-level="11.2.1" data-path="list.html"><a href="list.html#utilizzi-avanzati-selezione-1"><i class="fa fa-check"></i><b>11.2.1</b> Utilizzi Avanzati Selezione</a></li>
<li class="chapter" data-level="" data-path="list.html"><a href="list.html#esercizi-13"><i class="fa fa-check"></i>Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="list.html"><a href="list.html#funzioni-ed-operazioni-2"><i class="fa fa-check"></i><b>11.3</b> Funzioni ed Operazioni</a><ul>
<li class="chapter" data-level="11.3.1" data-path="list.html"><a href="list.html#attributi-di-una-lista"><i class="fa fa-check"></i><b>11.3.1</b> Attributi di una Lista</a></li>
<li class="chapter" data-level="11.3.2" data-path="list.html"><a href="list.html#unire-liste"><i class="fa fa-check"></i><b>11.3.2</b> Unire Liste</a></li>
<li class="chapter" data-level="11.3.3" data-path="list.html"><a href="list.html#informazioni-lista"><i class="fa fa-check"></i><b>11.3.3</b> Informazioni Lista</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="list.html"><a href="list.html#struttura-nested"><i class="fa fa-check"></i><b>11.4</b> Struttura Nested</a></li>
</ul></li>
<li class="part"><span><b>Algoritmi</b></span></li>
<li class="chapter" data-level="" data-path="third-section.html"><a href="third-section.html"><i class="fa fa-check"></i>Introduzione</a></li>
<li class="chapter" data-level="12" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>12</b> Definizione di Funzioni</a><ul>
<li class="chapter" data-level="12.1" data-path="functions.html"><a href="functions.html#creazione-di-una-funzione"><i class="fa fa-check"></i><b>12.1</b> Creazione di una Funzione</a><ul>
<li class="chapter" data-level="12.1.1" data-path="functions.html"><a href="functions.html#definire-input-e-output"><i class="fa fa-check"></i><b>12.1.1</b> Definire Input e Output</a></li>
<li class="chapter" data-level="" data-path="functions.html"><a href="functions.html#esercizi-14"><i class="fa fa-check"></i>Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="functions.html"><a href="functions.html#lavorare-con-le-funzioni"><i class="fa fa-check"></i><b>12.2</b> Lavorare con le Funzioni</a></li>
<li class="chapter" data-level="12.3" data-path="functions.html"><a href="functions.html#ambiente-della-funzione"><i class="fa fa-check"></i><b>12.3</b> Ambiente della funzione</a></li>
<li class="chapter" data-level="12.4" data-path="functions.html"><a href="functions.html#best-practice"><i class="fa fa-check"></i><b>12.4</b> Best practice</a><ul>
<li class="chapter" data-level="12.4.1" data-path="functions.html"><a href="functions.html#quando-serve-una-funzione"><i class="fa fa-check"></i><b>12.4.1</b> Quando serve una funzione?</a></li>
<li class="chapter" data-level="12.4.2" data-path="functions.html"><a href="functions.html#scegliere-il-nome"><i class="fa fa-check"></i><b>12.4.2</b> Scegliere il nome</a></li>
<li class="chapter" data-level="12.4.3" data-path="functions.html"><a href="functions.html#semplificare-la-quantita-di-operazioni-e-output"><i class="fa fa-check"></i><b>12.4.3</b> Semplificare la quantita di operazioni e output</a></li>
<li class="chapter" data-level="12.4.4" data-path="functions.html"><a href="functions.html#commentare-e-documentare"><i class="fa fa-check"></i><b>12.4.4</b> Commentare e documentare</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="functions.html"><a href="functions.html#importare-una-funzione"><i class="fa fa-check"></i><b>12.5</b> Importare una funzione</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="conditionals.html"><a href="conditionals.html"><i class="fa fa-check"></i><b>13</b> Programmazione Condizionale</a><ul>
<li class="chapter" data-level="13.1" data-path="conditionals.html"><a href="conditionals.html#strutture-condizionali"><i class="fa fa-check"></i><b>13.1</b> Strutture condizionali</a><ul>
<li class="chapter" data-level="13.1.1" data-path="conditionals.html"><a href="conditionals.html#if"><i class="fa fa-check"></i><b>13.1.1</b> if</a></li>
<li class="chapter" data-level="13.1.2" data-path="conditionals.html"><a href="conditionals.html#ifelse"><i class="fa fa-check"></i><b>13.1.2</b> if…else</a></li>
<li class="chapter" data-level="13.1.3" data-path="conditionals.html"><a href="conditionals.html#nested"><i class="fa fa-check"></i><b>13.1.3</b> Nested</a></li>
<li class="chapter" data-level="" data-path="conditionals.html"><a href="conditionals.html#esercizi-15"><i class="fa fa-check"></i>Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="conditionals.html"><a href="conditionals.html#altri-operatori-condizionali"><i class="fa fa-check"></i><b>13.2</b> Altri Operatori Condizionali</a><ul>
<li class="chapter" data-level="13.2.1" data-path="conditionals.html"><a href="conditionals.html#switch"><i class="fa fa-check"></i><b>13.2.1</b> switch</a></li>
<li class="chapter" data-level="13.2.2" data-path="conditionals.html"><a href="conditionals.html#ifelse-1"><i class="fa fa-check"></i><b>13.2.2</b> ifelse</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="loop.html"><a href="loop.html"><i class="fa fa-check"></i><b>14</b> Programmazione Iterativa</a><ul>
<li class="chapter" data-level="14.1" data-path="loop.html"><a href="loop.html#loop-1"><i class="fa fa-check"></i><b>14.1</b> Loop</a><ul>
<li class="chapter" data-level="14.1.1" data-path="loop.html"><a href="loop.html#for"><i class="fa fa-check"></i><b>14.1.1</b> For</a></li>
<li class="chapter" data-level="14.1.2" data-path="loop.html"><a href="loop.html#while"><i class="fa fa-check"></i><b>14.1.2</b> While</a></li>
<li class="chapter" data-level="14.1.3" data-path="loop.html"><a href="loop.html#next-e-brake"><i class="fa fa-check"></i><b>14.1.3</b> Next e Brake</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="loop.html"><a href="loop.html#nested-loop"><i class="fa fa-check"></i><b>14.2</b> Nested loop</a><ul>
<li class="chapter" data-level="" data-path="loop.html"><a href="loop.html#esercizi-16"><i class="fa fa-check"></i>Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="loop.html"><a href="loop.html#apply-family"><i class="fa fa-check"></i><b>14.3</b> Apply Family</a><ul>
<li class="chapter" data-level="14.3.1" data-path="loop.html"><a href="loop.html#quali-funzioni-applicare"><i class="fa fa-check"></i><b>14.3.1</b> Quali funzioni applicare?</a></li>
<li class="chapter" data-level="14.3.2" data-path="loop.html"><a href="loop.html#apply"><i class="fa fa-check"></i><b>14.3.2</b> apply</a></li>
<li class="chapter" data-level="14.3.3" data-path="loop.html"><a href="loop.html#tapply"><i class="fa fa-check"></i><b>14.3.3</b> tapply</a></li>
<li class="chapter" data-level="14.3.4" data-path="loop.html"><a href="loop.html#lapply"><i class="fa fa-check"></i><b>14.3.4</b> lapply</a></li>
<li class="chapter" data-level="14.3.5" data-path="loop.html"><a href="loop.html#sapply"><i class="fa fa-check"></i><b>14.3.5</b> sapply</a></li>
<li class="chapter" data-level="14.3.6" data-path="loop.html"><a href="loop.html#vapply"><i class="fa fa-check"></i><b>14.3.6</b> vapply</a></li>
<li class="chapter" data-level="14.3.7" data-path="loop.html"><a href="loop.html#lista-di-funzioni-a-lista-di-oggetti"><i class="fa fa-check"></i><b>14.3.7</b> Lista di funzioni a lista di oggetti</a></li>
<li class="chapter" data-level="14.3.8" data-path="loop.html"><a href="loop.html#mapply"><i class="fa fa-check"></i><b>14.3.8</b> mapply</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="loop.html"><a href="loop.html#replicate"><i class="fa fa-check"></i><b>14.4</b> Replicate</a></li>
</ul></li>
<li class="part"><span><b>Case study</b></span></li>
<li class="chapter" data-level="" data-path="introduzione-1.html"><a href="introduzione-1.html"><i class="fa fa-check"></i>Introduzione</a></li>
<li class="chapter" data-level="15" data-path="attachment.html"><a href="attachment.html"><i class="fa fa-check"></i><b>15</b> Caso Studio I: Attaccamento</a><ul>
<li class="chapter" data-level="15.1" data-path="attachment.html"><a href="attachment.html#infobox"><i class="fa fa-check"></i><b>15.1</b> Infobox</a></li>
</ul></li>
<li class="part"><span><b>Argomenti avanzati</b></span></li>
<li class="chapter" data-level="" data-path="fourth-section.html"><a href="fourth-section.html"><i class="fa fa-check"></i>Introduzione</a></li>
<li class="chapter" data-level="16" data-path="stringhe.html"><a href="stringhe.html"><i class="fa fa-check"></i><b>16</b> Stringhe</a><ul>
<li class="chapter" data-level="16.1" data-path="stringhe.html"><a href="stringhe.html#confrontare-stringhe"><i class="fa fa-check"></i><b>16.1</b> Confrontare stringhe</a></li>
<li class="chapter" data-level="16.2" data-path="stringhe.html"><a href="stringhe.html#comporre-stringhe"><i class="fa fa-check"></i><b>16.2</b> Comporre stringhe</a><ul>
<li class="chapter" data-level="16.2.1" data-path="stringhe.html"><a href="stringhe.html#tolower-e-toupper"><i class="fa fa-check"></i><b>16.2.1</b> <code>tolower()</code> e <code>toupper()</code></a></li>
<li class="chapter" data-level="16.2.2" data-path="stringhe.html"><a href="stringhe.html#paste-e-paste0"><i class="fa fa-check"></i><b>16.2.2</b> <code>paste()</code> e <code>paste0()</code></a></li>
<li class="chapter" data-level="16.2.3" data-path="stringhe.html"><a href="stringhe.html#sprinf"><i class="fa fa-check"></i><b>16.2.3</b> <code>sprinf()</code></a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="stringhe.html"><a href="stringhe.html#indicizzare-stringhe"><i class="fa fa-check"></i><b>16.3</b> Indicizzare stringhe</a><ul>
<li class="chapter" data-level="16.3.1" data-path="stringhe.html"><a href="stringhe.html#nchar"><i class="fa fa-check"></i><b>16.3.1</b> <code>nchar()</code></a></li>
<li class="chapter" data-level="16.3.2" data-path="stringhe.html"><a href="stringhe.html#gregexpr-e-regexpr"><i class="fa fa-check"></i><b>16.3.2</b> <code>gregexpr()</code> e <code>regexpr()</code></a></li>
<li class="chapter" data-level="16.3.3" data-path="stringhe.html"><a href="stringhe.html#substr-e-substring"><i class="fa fa-check"></i><b>16.3.3</b> <code>substr()</code> e <code>substring()</code></a></li>
<li class="chapter" data-level="16.3.4" data-path="stringhe.html"><a href="stringhe.html#startwith-e-endswith"><i class="fa fa-check"></i><b>16.3.4</b> <code>startWith()</code> e <code>endsWith()</code></a></li>
<li class="chapter" data-level="16.3.5" data-path="stringhe.html"><a href="stringhe.html#grep-e-grepl"><i class="fa fa-check"></i><b>16.3.5</b> <code>grep()</code> e <code>grepl()</code></a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="stringhe.html"><a href="stringhe.html#manipolare-stringhe"><i class="fa fa-check"></i><b>16.4</b> Manipolare stringhe</a><ul>
<li class="chapter" data-level="16.4.1" data-path="stringhe.html"><a href="stringhe.html#gsub-e-sub"><i class="fa fa-check"></i><b>16.4.1</b> <code>gsub()</code> e <code>sub()</code></a></li>
<li class="chapter" data-level="16.4.2" data-path="stringhe.html"><a href="stringhe.html#strsplit"><i class="fa fa-check"></i><b>16.4.2</b> <code>strsplit()</code></a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="stringhe.html"><a href="stringhe.html#regular-expression-regex"><i class="fa fa-check"></i><b>16.5</b> Regular Expression (REGEX)</a></li>
<li class="chapter" data-level="16.6" data-path="stringhe.html"><a href="stringhe.html#per-approfondire"><i class="fa fa-check"></i><b>16.6</b> Per approfondire</a><ul>
<li class="chapter" data-level="16.6.1" data-path="stringhe.html"><a href="stringhe.html#risorse-utili-1"><i class="fa fa-check"></i><b>16.6.1</b> Risorse utili</a></li>
<li class="chapter" data-level="16.6.2" data-path="stringhe.html"><a href="stringhe.html#altre-funzioni-utili"><i class="fa fa-check"></i><b>16.6.2</b> Altre funzioni utili</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><span style="font-size: 2.5em">Introduction to R</span></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <!--script src="https://kit.fontawesome.com/6a26f47516.js"></script-->
  <script src="assets/hideOutput.js"></script>
  <link href="assets/style.css" rel="stylesheet">
</head>



<div class="hero-image-container">
  <img class= "hero-image" src="images/banner.png">
</div>
<div id="loop" class="section level1">
<h1><span class="header-section-number">Capitolo 14</span> Programmazione Iterativa</h1>
<p>L’essenza della maggior parte delle operazioni nei vari linguaggi di programmazione è quella del concetto di <strong>iterazione</strong>. Iterazione significa ripetere una porzione di codice un certo numero di volte o fino anche una condizione viene soddisfatta.</p>
<p>Molte delle funzioni che abbiamo usato finora come la funzione <code>sum()</code> o la funzione <code>mean()</code> si basano su operazioni iterative. In R, purtroppo o per fortuna, userete abbastanza raramente delle iterazioni tramite loop anche se nella maggior parte delle funzioni sono presenti. Infatti molte delle funzioni implementate in R sono disponibili solo con pacchetti esterni oppure devono essere scritte manualmente implementando strutture iterative.</p>
<div id="loop-1" class="section level2">
<h2><span class="header-section-number">14.1</span> Loop</h2>
<div id="for" class="section level3">
<h3><span class="header-section-number">14.1.1</span> For</h3>
<p>Il primo tipo di struttura iterativa viene denominata ciclo <code>for</code>. L’idea è quella di ripetere una serie di istruzioni un numero <strong>predefinito</strong> di volte.La Figura <a href="loop.html#fig:plot-for-loop">14.1</a> rappresenta l’ idea di un ciclo <code>for</code>. In modo simile alle strutture condizionali del capitolo precedente, quando scriviamo un ciclo, entriamo in una parte di codice temporaneamente, eseguiamo le operazioni richieste e poi continuiamo con il resto del codice. Quello che nell’immagine è chiamato <code>i</code> è un modo convenzionale di indicare il conteggio delle operazioni. Se vogliamo ripetere un’operazione 1000 volte, <code>i</code> parte da 1 e arriva fino a 1000.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="loop.html#cb293-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;images/for_loop.png&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-for-loop"></span>
<img src="images/for_loop.png" alt="Rappresentazione for loop" width="65%" />
<p class="caption">
Figure 14.1: Rappresentazione for loop
</p>
</div>
<div id="struttura-for-loop" class="section level4 unnumbered">
<h4>Struttura For Loop</h4>
<p>In R la scrittura del ciclo <code>for</code> è la seguente:</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="loop.html#cb294-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">c</span>(...)) {</span>
<span id="cb294-2"><a href="loop.html#cb294-2"></a>    <span class="op">&lt;</span>codice<span class="op">-</span>da<span class="op">-</span>eseguire<span class="op">&gt;</span></span>
<span id="cb294-3"><a href="loop.html#cb294-3"></a>}</span></code></pre></div>
<ul>
<li><code>i</code> è un nome generico per indicare la variabile conteggio che abbiamo introdotto prima. Può essere qualsiasi carattere, ma solitamente per un ciclo generico si utilizzano singole lettere come <code>i</code> o <code>j</code> proabilmente per una similarità con la notazione matematica che spesso utilizza queste lettere per indicare una serie di elementi</li>
<li><code>in</code> è l’operatore per indicare che <code>i</code> varia rispetto ai valori specificati di seguito</li>
<li><code>c(...)</code> è il range di valori che assumerà <code>i</code> in per ogni iterazione</li>
</ul>
<p>Possiamo riformulare il codice in:</p>
<blockquote>
<p>Ripeti le operazioni incluse tra {} un numero di volte uguale alla lunghezza di <code>c(...)</code> e in questo ciclo, <code>i</code> assumerà, uno alla volta i valori contenuti in <code>c(...)</code>.</p>
</blockquote>
<p>Informalmente ci sono due tipi di ciclo, quello che utilizza un counter generico da assegnare a <code>i</code> e un’altro che utilizza direttamente dei valori di interesse.</p>
</div>
<div id="esempio-5" class="section level4 unnumbered">
<h4>Esempio</h4>
<ul>
<li>Loop con direttamente i valori di interesse</li>
</ul>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="loop.html#cb295-1"></a><span class="co"># numerico</span></span>
<span id="cb295-2"><a href="loop.html#cb295-2"></a><span class="co"># caratteri</span></span>
<span id="cb295-3"><a href="loop.html#cb295-3"></a><span class="cf">for</span> (name <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;Alessio&quot;</span>, <span class="st">&quot;Beatrice&quot;</span>, <span class="st">&quot;Carlo&quot;</span>)){</span>
<span id="cb295-4"><a href="loop.html#cb295-4"></a>  <span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;Ciao &quot;</span>, name))</span>
<span id="cb295-5"><a href="loop.html#cb295-5"></a>}</span>
<span id="cb295-6"><a href="loop.html#cb295-6"></a><span class="co">## [1] &quot;Ciao Alessio&quot;</span></span>
<span id="cb295-7"><a href="loop.html#cb295-7"></a><span class="co">## [1] &quot;Ciao Beatrice&quot;</span></span>
<span id="cb295-8"><a href="loop.html#cb295-8"></a><span class="co">## [1] &quot;Ciao Carlo&quot;</span></span></code></pre></div>
<p>Loop che utilizza un counter generico per indicizzare gli elementi:</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="loop.html#cb296-1"></a>my_vector &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">93</span>, <span class="dv">27</span>, <span class="dv">46</span>, <span class="dv">99</span>)</span>
<span id="cb296-2"><a href="loop.html#cb296-2"></a></span>
<span id="cb296-3"><a href="loop.html#cb296-3"></a><span class="co"># i in 1:length(my_vector)</span></span>
<span id="cb296-4"><a href="loop.html#cb296-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(my_vector)){</span>
<span id="cb296-5"><a href="loop.html#cb296-5"></a>  <span class="kw">print</span>(my_vector[i])</span>
<span id="cb296-6"><a href="loop.html#cb296-6"></a>}</span>
<span id="cb296-7"><a href="loop.html#cb296-7"></a><span class="co">## [1] 93</span></span>
<span id="cb296-8"><a href="loop.html#cb296-8"></a><span class="co">## [1] 27</span></span>
<span id="cb296-9"><a href="loop.html#cb296-9"></a><span class="co">## [1] 46</span></span>
<span id="cb296-10"><a href="loop.html#cb296-10"></a><span class="co">## [1] 99</span></span></code></pre></div>
<p>Questa distinzione è molto utile e spesso fonte di errori. Se si utilizza direttamente il vettore e il nostro counter assume i valori del vettore, “perdiamo” un indice di posizione. Nell’esempio del ciclo con i nomi infatti, se volessimo sapere e stampare quale posizione occupa Alessio dobbiamo modificare l’approccio, puntando ad utilizzando anche counter generico. Possiamo crearlo fuori dal ciclo e aggiornarlo manualmente:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="loop.html#cb297-1"></a>i &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb297-2"><a href="loop.html#cb297-2"></a><span class="cf">for</span> (name <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;Alessio&quot;</span>, <span class="st">&quot;Beatrice&quot;</span>, <span class="st">&quot;Carlo&quot;</span>)){</span>
<span id="cb297-3"><a href="loop.html#cb297-3"></a>  <span class="kw">print</span>(<span class="kw">paste0</span>(name, <span class="st">&quot; è il numero &quot;</span>, i))</span>
<span id="cb297-4"><a href="loop.html#cb297-4"></a>  i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb297-5"><a href="loop.html#cb297-5"></a>}</span>
<span id="cb297-6"><a href="loop.html#cb297-6"></a><span class="co">## [1] &quot;Alessio è il numero 1&quot;</span></span>
<span id="cb297-7"><a href="loop.html#cb297-7"></a><span class="co">## [1] &quot;Beatrice è il numero 2&quot;</span></span>
<span id="cb297-8"><a href="loop.html#cb297-8"></a><span class="co">## [1] &quot;Carlo è il numero 3&quot;</span></span></code></pre></div>
<p>In generale, il modo migliore è sempre quello di utilizzare un ciclo utilizza indici e non i valori effettivi, in modo da poter accedere comunque entrambe le informazioni.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="loop.html#cb298-1"></a>nomi &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Alessio&quot;</span>, <span class="st">&quot;Beatrice&quot;</span>, <span class="st">&quot;Carlo&quot;</span>)</span>
<span id="cb298-2"><a href="loop.html#cb298-2"></a></span>
<span id="cb298-3"><a href="loop.html#cb298-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(nomi)){</span>
<span id="cb298-4"><a href="loop.html#cb298-4"></a>  <span class="kw">print</span>(<span class="kw">paste0</span>(nomi[i], <span class="st">&quot; è il numero &quot;</span>, i))</span>
<span id="cb298-5"><a href="loop.html#cb298-5"></a>}</span>
<span id="cb298-6"><a href="loop.html#cb298-6"></a><span class="co">## [1] &quot;Alessio è il numero 1&quot;</span></span>
<span id="cb298-7"><a href="loop.html#cb298-7"></a><span class="co">## [1] &quot;Beatrice è il numero 2&quot;</span></span>
<span id="cb298-8"><a href="loop.html#cb298-8"></a><span class="co">## [1] &quot;Carlo è il numero 3&quot;</span></span></code></pre></div>
<div class="trick" title="seq_along() ">
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="loop.html#cb299-1"></a>my_vector &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">93</span>, <span class="dv">27</span>, <span class="dv">46</span>, <span class="dv">99</span>)</span>
<span id="cb299-2"><a href="loop.html#cb299-2"></a>my_NULL &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb299-3"><a href="loop.html#cb299-3"></a></span>
<span id="cb299-4"><a href="loop.html#cb299-4"></a><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(my_vector)</span>
<span id="cb299-5"><a href="loop.html#cb299-5"></a><span class="co">## [1] 1 2 3 4</span></span>
<span id="cb299-6"><a href="loop.html#cb299-6"></a><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(my_NULL)</span>
<span id="cb299-7"><a href="loop.html#cb299-7"></a><span class="co">## [1] 1 0</span></span>
<span id="cb299-8"><a href="loop.html#cb299-8"></a></span>
<span id="cb299-9"><a href="loop.html#cb299-9"></a><span class="kw">seq_along</span>(my_vector)</span>
<span id="cb299-10"><a href="loop.html#cb299-10"></a><span class="co">## [1] 1 2 3 4</span></span>
<span id="cb299-11"><a href="loop.html#cb299-11"></a><span class="kw">seq_along</span>(my_NULL)</span>
<span id="cb299-12"><a href="loop.html#cb299-12"></a><span class="co">## integer(0)</span></span>
<span id="cb299-13"><a href="loop.html#cb299-13"></a></span>
<span id="cb299-14"><a href="loop.html#cb299-14"></a><span class="kw">seq_len</span>(<span class="kw">length</span>(my_vector))</span>
<span id="cb299-15"><a href="loop.html#cb299-15"></a><span class="co">## [1] 1 2 3 4</span></span>
<span id="cb299-16"><a href="loop.html#cb299-16"></a><span class="kw">seq_len</span>(<span class="kw">length</span>(my_NULL))</span>
<span id="cb299-17"><a href="loop.html#cb299-17"></a><span class="co">## integer(0)</span></span></code></pre></div>
</div>
</div>
<div id="esempio-la-funzione-somma" class="section level4 unnumbered">
<h4>Esempio: la funzione somma</h4>
<p>Come introdotto all’inizio di questo capitolo, molte delle funzioni disponibili in R derivano da strutture iterative. Se pensiamo alla funzione <code>sum()</code> sappiamo che possiamo calcolare la somma di un vettore semplicemente con <code>sum(x)</code>. Per capire appieno i cicli, è interessante pensare e implementare le funzioni comuni.</p>
<p>Se dovessimo sommare <code>n</code> numeri a mano la struttura sarebbe questa:</p>
<ul>
<li>prendo il primo numero <span class="math inline">\(x_1\)</span> e lo sommo con il secondo <span class="math inline">\(x_2\)</span></li>
<li>ottengo un nuovo numero <code>x_{1+2}</code></li>
<li>prendo il terzo numero <span class="math inline">\(x_3\)</span> e lo sommo a <code>x_{1+2}</code></li>
<li>ottengo <span class="math inline">\(x_{1+2+3}\)</span></li>
<li>ripeto questa operazione fino all’ultimo elemento di <span class="math inline">\(x_n\)</span></li>
</ul>
<p>Come vedete, questa è una struttura iterativa, che conta da 1 alla lunghezza di <span class="math inline">\(x\)</span> ed ogni iterazione somma il successivo con la somma dei precedenti. In R:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="loop.html#cb300-1"></a>my_values &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>)</span>
<span id="cb300-2"><a href="loop.html#cb300-2"></a></span>
<span id="cb300-3"><a href="loop.html#cb300-3"></a><span class="co"># Calcolare somma valori</span></span>
<span id="cb300-4"><a href="loop.html#cb300-4"></a>my_sum &lt;-<span class="st"> </span><span class="dv">0</span>      <span class="co"># inizializzo valore</span></span>
<span id="cb300-5"><a href="loop.html#cb300-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(my_values)){</span>
<span id="cb300-6"><a href="loop.html#cb300-6"></a>  my_sum &lt;-<span class="st"> </span>my_sum <span class="op">+</span><span class="st"> </span>my_values[i]</span>
<span id="cb300-7"><a href="loop.html#cb300-7"></a>}</span>
<span id="cb300-8"><a href="loop.html#cb300-8"></a></span>
<span id="cb300-9"><a href="loop.html#cb300-9"></a>my_sum</span>
<span id="cb300-10"><a href="loop.html#cb300-10"></a><span class="co">## [1] 20</span></span></code></pre></div>
<p>La struttura è la stessa del nostro ragionamento in precedenza. Creo una variabile “partenza” che assume valore 0 ed ogni iterazione sommo indicizzando il rispettivo elemento.</p>
</div>
<div id="esempio-creo-un-vettore" class="section level4 unnumbered">
<h4>Esempio: creo un vettore</h4>
<p>Essendo che utilizziamo un indice che assume un range di valori, possiamo non solo accedere ad un vettore utilizzando il nostro indice ma anche creare o sostituire un vettore progressivamente.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="loop.html#cb301-1"></a><span class="co"># Calcola la somma di colonna</span></span>
<span id="cb301-2"><a href="loop.html#cb301-2"></a>my_matrix &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">6</span>)</span>
<span id="cb301-3"><a href="loop.html#cb301-3"></a></span>
<span id="cb301-4"><a href="loop.html#cb301-4"></a><span class="co"># Metodo non efficiente (aggiungo valori)</span></span>
<span id="cb301-5"><a href="loop.html#cb301-5"></a>sum_cols &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb301-6"><a href="loop.html#cb301-6"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="kw">seq_len</span>(<span class="kw">ncol</span>(my_matrix))){</span>
<span id="cb301-7"><a href="loop.html#cb301-7"></a>  sum_col &lt;-<span class="st"> </span><span class="kw">sum</span>(my_matrix[, i])   <span class="co"># calcolo i esima colonna</span></span>
<span id="cb301-8"><a href="loop.html#cb301-8"></a>  sum_cols &lt;-<span class="st"> </span><span class="kw">c</span>(sum_cols, sum_col) <span class="co"># aggiungo il risultato</span></span>
<span id="cb301-9"><a href="loop.html#cb301-9"></a>}</span>
<span id="cb301-10"><a href="loop.html#cb301-10"></a></span>
<span id="cb301-11"><a href="loop.html#cb301-11"></a>sum_cols</span>
<span id="cb301-12"><a href="loop.html#cb301-12"></a><span class="co">## [1] 10 26 42 58 74 90</span></span>
<span id="cb301-13"><a href="loop.html#cb301-13"></a></span>
<span id="cb301-14"><a href="loop.html#cb301-14"></a><span class="co"># Metodo efficiente (aggiorno valori)</span></span>
<span id="cb301-15"><a href="loop.html#cb301-15"></a>sum_cols &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode =</span> <span class="st">&quot;double&quot;</span>, <span class="dt">length =</span> <span class="kw">ncol</span>(my_matrix))</span>
<span id="cb301-16"><a href="loop.html#cb301-16"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="kw">seq_along</span>(sum_cols)){</span>
<span id="cb301-17"><a href="loop.html#cb301-17"></a>  sum_col &lt;-<span class="st"> </span><span class="kw">sum</span>(my_matrix[, i])   <span class="co"># calcolo i esima colonna</span></span>
<span id="cb301-18"><a href="loop.html#cb301-18"></a>  sum_cols[i] &lt;-<span class="st">  </span>sum_col <span class="co"># aggiorno il risultato</span></span>
<span id="cb301-19"><a href="loop.html#cb301-19"></a>}</span>
<span id="cb301-20"><a href="loop.html#cb301-20"></a></span>
<span id="cb301-21"><a href="loop.html#cb301-21"></a>sum_cols</span>
<span id="cb301-22"><a href="loop.html#cb301-22"></a><span class="co">## [1] 10 26 42 58 74 90</span></span></code></pre></div>
</div>
</div>
<div id="while" class="section level3">
<h3><span class="header-section-number">14.1.2</span> While</h3>
<p>Il ciclo <code>while</code> può essere considerato come una generalizzazione del ciclo <code>for</code>. In altri termini il ciclo <code>for</code> è un tipo particolare di ciclo <code>while</code>.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="loop.html#cb302-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;images/while_loop.png&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-while-loop"></span>
<img src="images/while_loop.png" alt="Rappresentazione while loop" width="65%" />
<p class="caption">
Figure 14.2: Rappresentazione while loop
</p>
</div>
<div id="struttura-while-loop" class="section level4 unnumbered">
<h4>Struttura While Loop</h4>
<p>La scrittura è più concisa del ciclo <code>for</code> perchè non definiamo nessun counter o placeholder e nemmeno un vettore di valori. L’unica cosa che muove un ciclo <code>while</code> è una condizione logica (quindi con valori booleani <code>TRUE</code> e <code>FALSE</code>). Anche qui, parafrasando:</p>
<blockquote>
<p>Ripeti le operazioni incluse tra {} fino a che la condizione <code>&lt;test&gt;</code> è VERA.</p>
</blockquote>
<p>In altri termini, ad ogni iterazione la condizione <code>&lt;test&gt;</code> viene valutata. Se questa è vera, viene eseguita l’operazione altrimenti il ciclo si ferma.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="loop.html#cb303-1"></a><span class="cf">while</span> (<span class="op">&lt;</span>test<span class="op">&gt;</span>) {</span>
<span id="cb303-2"><a href="loop.html#cb303-2"></a>    <span class="op">&lt;</span>codice<span class="op">-</span>da<span class="op">-</span>eseguire<span class="op">&gt;</span></span>
<span id="cb303-3"><a href="loop.html#cb303-3"></a>}</span></code></pre></div>
</div>
<div id="esempio-6" class="section level4 unnumbered">
<h4>Esempio</h4>
<p>Se vogliamo fare un <strong>conto alla rovescia</strong></p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="loop.html#cb304-1"></a>count &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb304-2"><a href="loop.html#cb304-2"></a></span>
<span id="cb304-3"><a href="loop.html#cb304-3"></a><span class="cf">while</span>(count <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>){</span>
<span id="cb304-4"><a href="loop.html#cb304-4"></a>  <span class="kw">print</span>(count)</span>
<span id="cb304-5"><a href="loop.html#cb304-5"></a>  count &lt;-<span class="st"> </span>count <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="co"># aggiorno variabile</span></span>
<span id="cb304-6"><a href="loop.html#cb304-6"></a>}</span>
<span id="cb304-7"><a href="loop.html#cb304-7"></a><span class="co">## [1] 5</span></span>
<span id="cb304-8"><a href="loop.html#cb304-8"></a><span class="co">## [1] 4</span></span>
<span id="cb304-9"><a href="loop.html#cb304-9"></a><span class="co">## [1] 3</span></span>
<span id="cb304-10"><a href="loop.html#cb304-10"></a><span class="co">## [1] 2</span></span>
<span id="cb304-11"><a href="loop.html#cb304-11"></a><span class="co">## [1] 1</span></span>
<span id="cb304-12"><a href="loop.html#cb304-12"></a><span class="co">## [1] 0</span></span></code></pre></div>
<p>Quando si scrive un ciclo <code>while</code> è importante assicurarsi di due cose:</p>
<ul>
<li>Che la condizione sia <code>TRUE</code> inizialmente, altrimenti il ciclo non comincierà nemmeno</li>
<li>Che ad un certo punto la condizione diventi <code>FALSE</code> (perchè abbiamo ottenuto il risultato o perchè è passato troppo tempo o iterazioni)</li>
</ul>
<p>Se la seconda condizione non è rispettata, otteniamo quelli che si chiamano <code>endless loop</code> come ad esempio:</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="loop.html#cb305-1"></a>count &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb305-2"><a href="loop.html#cb305-2"></a></span>
<span id="cb305-3"><a href="loop.html#cb305-3"></a><span class="co"># Attenzione loop infinito</span></span>
<span id="cb305-4"><a href="loop.html#cb305-4"></a><span class="cf">while</span>(count <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>){</span>
<span id="cb305-5"><a href="loop.html#cb305-5"></a>  <span class="kw">print</span>(count)</span>
<span id="cb305-6"><a href="loop.html#cb305-6"></a>  <span class="co"># count &lt;- count - 1 </span></span>
<span id="cb305-7"><a href="loop.html#cb305-7"></a>}</span></code></pre></div>
</div>
<div id="while-e-for" class="section level4">
<h4><span class="header-section-number">14.1.2.1</span> While e For</h4>
<p>Abbiamo introdotto in precedenza che il <code>for</code> è un tipo particolare di <code>while</code>. Concettualmente infatti possiamo pensare ad un <code>for</code> come un <code>while</code> dove il nostro counter <code>i</code> incrementa fino alla lunghezza del vettore su cui iterare. In altri termini possiamo scrivere un <code>for</code> anche in questo modo:</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="loop.html#cb306-1"></a>nomi &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Alessio&quot;</span>, <span class="st">&quot;Beatrice&quot;</span>, <span class="st">&quot;Carlo&quot;</span>)</span>
<span id="cb306-2"><a href="loop.html#cb306-2"></a>i &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># counter</span></span>
<span id="cb306-3"><a href="loop.html#cb306-3"></a></span>
<span id="cb306-4"><a href="loop.html#cb306-4"></a><span class="cf">while</span>(i <span class="op">&lt;=</span><span class="st"> </span><span class="kw">length</span>(nomi)){ <span class="co"># condizione</span></span>
<span id="cb306-5"><a href="loop.html#cb306-5"></a>  <span class="kw">print</span>(<span class="kw">paste0</span>(nomi[i], <span class="st">&quot; è il numero &quot;</span>, i))</span>
<span id="cb306-6"><a href="loop.html#cb306-6"></a>  i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb306-7"><a href="loop.html#cb306-7"></a>}</span>
<span id="cb306-8"><a href="loop.html#cb306-8"></a><span class="co">## [1] &quot;Alessio è il numero 1&quot;</span></span>
<span id="cb306-9"><a href="loop.html#cb306-9"></a><span class="co">## [1] &quot;Beatrice è il numero 2&quot;</span></span>
<span id="cb306-10"><a href="loop.html#cb306-10"></a><span class="co">## [1] &quot;Carlo è il numero 3&quot;</span></span></code></pre></div>
</div>
</div>
<div id="next-e-brake" class="section level3">
<h3><span class="header-section-number">14.1.3</span> Next e Brake</h3>
<p>All’interno di una struttura iterativa, possiamo eseguire qualsiasi tipo di operazione, ed anche includere strutture condizionali. Alcune volte può essere utile saltare una particolare iterazione oppure interrompere il ciclo iterativo. In R tali operazioni posso essere eseguite rispettivamene coni comandi <code>next</code> e <code>break</code>.</p>
<ul>
<li><code>next</code> - passa all’iterazione successiva</li>
<li><code>break</code> - interrompe l’esecuzione del ciclo</li>
</ul>
<div id="esempio-7" class="section level4 unnumbered">
<h4>Esempio</h4>
<ul>
<li>con <code>for</code> loop</li>
</ul>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="loop.html#cb307-1"></a>my_vector &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">6</span></span>
<span id="cb307-2"><a href="loop.html#cb307-2"></a></span>
<span id="cb307-3"><a href="loop.html#cb307-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(my_vector)){</span>
<span id="cb307-4"><a href="loop.html#cb307-4"></a>  <span class="cf">if</span> (my_vector[i] <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) <span class="cf">next</span></span>
<span id="cb307-5"><a href="loop.html#cb307-5"></a>  </span>
<span id="cb307-6"><a href="loop.html#cb307-6"></a>  <span class="cf">if</span> (my_vector[i] <span class="op">==</span><span class="st"> </span><span class="dv">5</span>) <span class="cf">break</span></span>
<span id="cb307-7"><a href="loop.html#cb307-7"></a>  <span class="kw">print</span>(my_vector[i])</span>
<span id="cb307-8"><a href="loop.html#cb307-8"></a>}</span>
<span id="cb307-9"><a href="loop.html#cb307-9"></a><span class="co">## [1] 1</span></span>
<span id="cb307-10"><a href="loop.html#cb307-10"></a><span class="co">## [1] 2</span></span>
<span id="cb307-11"><a href="loop.html#cb307-11"></a><span class="co">## [1] 4</span></span></code></pre></div>
<ul>
<li>con <code>while</code> loop</li>
</ul>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="loop.html#cb308-1"></a>count &lt;-<span class="st"> </span><span class="dv">7</span></span>
<span id="cb308-2"><a href="loop.html#cb308-2"></a></span>
<span id="cb308-3"><a href="loop.html#cb308-3"></a><span class="cf">while</span>(count <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>){</span>
<span id="cb308-4"><a href="loop.html#cb308-4"></a>  count &lt;-<span class="st"> </span>count <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb308-5"><a href="loop.html#cb308-5"></a>  <span class="cf">if</span> (count <span class="op">==</span><span class="st"> </span><span class="dv">5</span>) <span class="cf">next</span></span>
<span id="cb308-6"><a href="loop.html#cb308-6"></a>  </span>
<span id="cb308-7"><a href="loop.html#cb308-7"></a>  <span class="cf">if</span> (count <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) <span class="cf">break</span></span>
<span id="cb308-8"><a href="loop.html#cb308-8"></a>  </span>
<span id="cb308-9"><a href="loop.html#cb308-9"></a>  <span class="kw">print</span>(count)</span>
<span id="cb308-10"><a href="loop.html#cb308-10"></a>}</span>
<span id="cb308-11"><a href="loop.html#cb308-11"></a><span class="co">## [1] 6</span></span>
<span id="cb308-12"><a href="loop.html#cb308-12"></a><span class="co">## [1] 4</span></span>
<span id="cb308-13"><a href="loop.html#cb308-13"></a><span class="co">## [1] 3</span></span></code></pre></div>
</div>
</div>
</div>
<div id="nested-loop" class="section level2">
<h2><span class="header-section-number">14.2</span> Nested loop</h2>
<p>Una volta compresa la struttura iterativa, è facile espanderne le potenzialità inserendo un ciclo all’interno di un altro. Possiamo avere quanti cicli <em>nested</em> necessari, chiaramente aumenta non solo la complessità ma anche il tempo di esecuzione. Per capire al meglio cosa succede all’interno di un ciclo nested è utile visualizzare gli indici:</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="loop.html#cb309-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){ <span class="co"># livello 1</span></span>
<span id="cb309-2"><a href="loop.html#cb309-2"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){ <span class="co"># livello 2</span></span>
<span id="cb309-3"><a href="loop.html#cb309-3"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){ <span class="co"># livello 3</span></span>
<span id="cb309-4"><a href="loop.html#cb309-4"></a>      <span class="kw">print</span>(<span class="kw">paste</span>(i, j, l))</span>
<span id="cb309-5"><a href="loop.html#cb309-5"></a>    }</span>
<span id="cb309-6"><a href="loop.html#cb309-6"></a>  }</span>
<span id="cb309-7"><a href="loop.html#cb309-7"></a>}</span>
<span id="cb309-8"><a href="loop.html#cb309-8"></a><span class="co">## [1] &quot;1 1 1&quot;</span></span>
<span id="cb309-9"><a href="loop.html#cb309-9"></a><span class="co">## [1] &quot;1 1 2&quot;</span></span>
<span id="cb309-10"><a href="loop.html#cb309-10"></a><span class="co">## [1] &quot;1 1 3&quot;</span></span>
<span id="cb309-11"><a href="loop.html#cb309-11"></a><span class="co">## [1] &quot;1 2 1&quot;</span></span>
<span id="cb309-12"><a href="loop.html#cb309-12"></a><span class="co">## [1] &quot;1 2 2&quot;</span></span>
<span id="cb309-13"><a href="loop.html#cb309-13"></a><span class="co">## [1] &quot;1 2 3&quot;</span></span>
<span id="cb309-14"><a href="loop.html#cb309-14"></a><span class="co">## [1] &quot;1 3 1&quot;</span></span>
<span id="cb309-15"><a href="loop.html#cb309-15"></a><span class="co">## [1] &quot;1 3 2&quot;</span></span>
<span id="cb309-16"><a href="loop.html#cb309-16"></a><span class="co">## [1] &quot;1 3 3&quot;</span></span>
<span id="cb309-17"><a href="loop.html#cb309-17"></a><span class="co">## [1] &quot;2 1 1&quot;</span></span>
<span id="cb309-18"><a href="loop.html#cb309-18"></a><span class="co">## [1] &quot;2 1 2&quot;</span></span>
<span id="cb309-19"><a href="loop.html#cb309-19"></a><span class="co">## [1] &quot;2 1 3&quot;</span></span>
<span id="cb309-20"><a href="loop.html#cb309-20"></a><span class="co">## [1] &quot;2 2 1&quot;</span></span>
<span id="cb309-21"><a href="loop.html#cb309-21"></a><span class="co">## [1] &quot;2 2 2&quot;</span></span>
<span id="cb309-22"><a href="loop.html#cb309-22"></a><span class="co">## [1] &quot;2 2 3&quot;</span></span>
<span id="cb309-23"><a href="loop.html#cb309-23"></a><span class="co">## [1] &quot;2 3 1&quot;</span></span>
<span id="cb309-24"><a href="loop.html#cb309-24"></a><span class="co">## [1] &quot;2 3 2&quot;</span></span>
<span id="cb309-25"><a href="loop.html#cb309-25"></a><span class="co">## [1] &quot;2 3 3&quot;</span></span>
<span id="cb309-26"><a href="loop.html#cb309-26"></a><span class="co">## [1] &quot;3 1 1&quot;</span></span>
<span id="cb309-27"><a href="loop.html#cb309-27"></a><span class="co">## [1] &quot;3 1 2&quot;</span></span>
<span id="cb309-28"><a href="loop.html#cb309-28"></a><span class="co">## [1] &quot;3 1 3&quot;</span></span>
<span id="cb309-29"><a href="loop.html#cb309-29"></a><span class="co">## [1] &quot;3 2 1&quot;</span></span>
<span id="cb309-30"><a href="loop.html#cb309-30"></a><span class="co">## [1] &quot;3 2 2&quot;</span></span>
<span id="cb309-31"><a href="loop.html#cb309-31"></a><span class="co">## [1] &quot;3 2 3&quot;</span></span>
<span id="cb309-32"><a href="loop.html#cb309-32"></a><span class="co">## [1] &quot;3 3 1&quot;</span></span>
<span id="cb309-33"><a href="loop.html#cb309-33"></a><span class="co">## [1] &quot;3 3 2&quot;</span></span>
<span id="cb309-34"><a href="loop.html#cb309-34"></a><span class="co">## [1] &quot;3 3 3&quot;</span></span></code></pre></div>
<p>Guardando gli indici, è chiaro che il ciclo più interno viene ultimato per primo fino ad arrivare a quello più esterno. La logica è la seguente:</p>
<ul>
<li>La prima iterazione entriamo nel ciclo più esterno <code>i = 1</code>, poi in quello interno <code>j = 1</code> e in quello più interno <code>l = 1</code>.</li>
<li>nella seconda iterazione siamo <strong>bloccati</strong> nel ciclo interno e quindi sia <code>i</code> che <code>j</code> saranno 1 mentre <code>l</code> sarà uguale a 2.</li>
<li>quando il ciclo <code>l</code> sarà finito, <code>i</code> sarà sempre 1 mentre <code>j</code> passerà a 2 e così via</li>
</ul>
<p>Un aspetto importante è l’utilizzo di indici diversi, infatti i valori <code>i</code>, <code>j</code> e <code>l</code> assumono valori diversi ad ogni iterazione e se usassimo lo stesso indice, non otterremo il risultato voluto.</p>
<div id="esercizi-16" class="section level3 unnumbered">
<h3>Esercizi</h3>
<ol style="list-style-type: decimal">
<li>Scrivi una funzione che calcoli la media di un vettore numerico usando un for loop.</li>
<li>Scrivi una funzione che dato un vettore numerico restituisca il valore massimo e minimo usando un for loop (attenti al valore di inizializzazione).</li>
<li>Scrivi una funzione che per ogni iterazione generi <span class="math inline">\(n\)</span> osservazioni da una normale (funzione <code>rnorm()</code>) con media <span class="math inline">\(mu\)</span> e deviazione standard <span class="math inline">\(sigma\)</span>, salva la media di ogni campione. I parametri della funzione saranno <span class="math inline">\(n\)</span>, <span class="math inline">\(mu\)</span>, <span class="math inline">\(sigma\)</span> e <span class="math inline">\(iter\)</span> (numero di iterazioni).</li>
</ol>
</div>
</div>
<div id="apply-family" class="section level2">
<h2><span class="header-section-number">14.3</span> Apply Family</h2>
<p>Ci sono una famiglia di funzioni in R estremamente potenti e versatili chiamate <code>*apply</code>. L’asterisco suggerisce una serie di varianti presenti in R che nonostante la struttura e funzione comune hanno degli obiettivi diversi:</p>
<ul>
<li><code>apply</code>: dato un dataframe (o matrice) esegue la stessa funzione su ogni riga o colonna</li>
<li><code>tapply</code>: dato un vettore di valori esegue la stessa funzione su ogni gruppo che è satato definito</li>
<li><code>lapply</code>: esegue la stessa funzione per ogni elemento di una lista. Restituisce ancora una lista</li>
<li><code>sapply</code>: esegue la stessa funzione per ogni elemento di una lista. Restituisce se possibile un oggetto seplificato (un vettore, una matrice o un array)</li>
<li><code>vapply</code>: analogo a <code>sapply</code> ma richiede di definire il tipo di dati restituiti</li>
<li><code>mapply</code>: è la versione multivariata. Permette di applicare una funzione a più liste di elementi</li>
</ul>
<p>Prima di illustrare le varie funzioni è utile capire la struttura generale. In generale queste funzioni accettano un oggetto <strong>lista</strong> quindi un insieme di elementi e una <strong>funzione</strong>. L’idea infatti è quella di avere una funzione che accetta altre funzioni come argomenti e applichi la funzione-argomento ad ogni elemento in input.
Queste funzioni, sopratutto in R, sono spesso preferite rispetto ad utilizzare cicli <code>for</code> per velocità, compattezza e versatilità.
Hadley Wickam[^talk-map] riporta un bellissimo esempio per capire la diffenza tra <code>loop</code> e <code>*apply</code>. Immaginiamo di avere una serie di vettori e voler applicare alcune funzioni ad ogni vettore, possiamo impostare un semplice loop in questo modo:</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="loop.html#cb310-1"></a>list_vec &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb310-2"><a href="loop.html#cb310-2"></a>  vec1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb310-3"><a href="loop.html#cb310-3"></a>  vec2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb310-4"><a href="loop.html#cb310-4"></a>  vec3 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb310-5"><a href="loop.html#cb310-5"></a>  vec4 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb310-6"><a href="loop.html#cb310-6"></a>  vec5 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb310-7"><a href="loop.html#cb310-7"></a>)</span>
<span id="cb310-8"><a href="loop.html#cb310-8"></a></span>
<span id="cb310-9"><a href="loop.html#cb310-9"></a>means &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode =</span> <span class="st">&quot;numeric&quot;</span>, <span class="dt">length =</span> <span class="kw">length</span>(list_vec))</span>
<span id="cb310-10"><a href="loop.html#cb310-10"></a>medians &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode =</span> <span class="st">&quot;numeric&quot;</span>, <span class="dt">length =</span> <span class="kw">length</span>(list_vec))</span>
<span id="cb310-11"><a href="loop.html#cb310-11"></a>st_devs &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode =</span> <span class="st">&quot;numeric&quot;</span>, <span class="dt">length =</span> <span class="kw">length</span>(list_vec))</span>
<span id="cb310-12"><a href="loop.html#cb310-12"></a></span>
<span id="cb310-13"><a href="loop.html#cb310-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(list_vec)){</span>
<span id="cb310-14"><a href="loop.html#cb310-14"></a>  means[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(list_vec[[i]])</span>
<span id="cb310-15"><a href="loop.html#cb310-15"></a>  medians[i] &lt;-<span class="st"> </span><span class="kw">median</span>(list_vec[[i]])</span>
<span id="cb310-16"><a href="loop.html#cb310-16"></a>  st_devs[i] &lt;-<span class="st"> </span><span class="kw">sd</span>(list_vec[[i]])</span>
<span id="cb310-17"><a href="loop.html#cb310-17"></a>}</span></code></pre></div>
<p>Nonostante sia perfettamente corretto, questa scrittura ha diversi problemi:</p>
<ul>
<li>E’ molto ridondante. Tra calcolare media, mediana e deviazione standard l’unica cosa che cambia è la funzione applicata mentre dobbiamo per ognuno preallocare una variabile, impostare l’indicizzazione in base all’iterazione per selezionare l’elemento della lista e memorizzare il risultato. Per migliorare questa scrittura possiamo mettere in una funzione tutta questa struttura (preallocazione, indicizzazione e memorizzazione) e utilizzare questa funzione con argomenti la lista di input e la funzione da applicare. Utilizzando la funzione <code>sapply</code>:</li>
</ul>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="loop.html#cb311-1"></a>means &lt;-<span class="st"> </span><span class="kw">lapply</span>(list_vec, mean)</span>
<span id="cb311-2"><a href="loop.html#cb311-2"></a>means</span>
<span id="cb311-3"><a href="loop.html#cb311-3"></a><span class="co">## [[1]]</span></span>
<span id="cb311-4"><a href="loop.html#cb311-4"></a><span class="co">## [1] -0.1744844</span></span>
<span id="cb311-5"><a href="loop.html#cb311-5"></a><span class="co">## </span></span>
<span id="cb311-6"><a href="loop.html#cb311-6"></a><span class="co">## [[2]]</span></span>
<span id="cb311-7"><a href="loop.html#cb311-7"></a><span class="co">## [1] -0.001581971</span></span>
<span id="cb311-8"><a href="loop.html#cb311-8"></a><span class="co">## </span></span>
<span id="cb311-9"><a href="loop.html#cb311-9"></a><span class="co">## [[3]]</span></span>
<span id="cb311-10"><a href="loop.html#cb311-10"></a><span class="co">## [1] 0.003746107</span></span>
<span id="cb311-11"><a href="loop.html#cb311-11"></a><span class="co">## </span></span>
<span id="cb311-12"><a href="loop.html#cb311-12"></a><span class="co">## [[4]]</span></span>
<span id="cb311-13"><a href="loop.html#cb311-13"></a><span class="co">## [1] -0.1040844</span></span>
<span id="cb311-14"><a href="loop.html#cb311-14"></a><span class="co">## </span></span>
<span id="cb311-15"><a href="loop.html#cb311-15"></a><span class="co">## [[5]]</span></span>
<span id="cb311-16"><a href="loop.html#cb311-16"></a><span class="co">## [1] 0.2978849</span></span>
<span id="cb311-17"><a href="loop.html#cb311-17"></a>medians &lt;-<span class="st"> </span><span class="kw">lapply</span>(list_vec, median)</span>
<span id="cb311-18"><a href="loop.html#cb311-18"></a>medians</span>
<span id="cb311-19"><a href="loop.html#cb311-19"></a><span class="co">## [[1]]</span></span>
<span id="cb311-20"><a href="loop.html#cb311-20"></a><span class="co">## [1] -0.1336871</span></span>
<span id="cb311-21"><a href="loop.html#cb311-21"></a><span class="co">## </span></span>
<span id="cb311-22"><a href="loop.html#cb311-22"></a><span class="co">## [[2]]</span></span>
<span id="cb311-23"><a href="loop.html#cb311-23"></a><span class="co">## [1] 0.08244486</span></span>
<span id="cb311-24"><a href="loop.html#cb311-24"></a><span class="co">## </span></span>
<span id="cb311-25"><a href="loop.html#cb311-25"></a><span class="co">## [[3]]</span></span>
<span id="cb311-26"><a href="loop.html#cb311-26"></a><span class="co">## [1] 0.002455108</span></span>
<span id="cb311-27"><a href="loop.html#cb311-27"></a><span class="co">## </span></span>
<span id="cb311-28"><a href="loop.html#cb311-28"></a><span class="co">## [[4]]</span></span>
<span id="cb311-29"><a href="loop.html#cb311-29"></a><span class="co">## [1] -0.00886783</span></span>
<span id="cb311-30"><a href="loop.html#cb311-30"></a><span class="co">## </span></span>
<span id="cb311-31"><a href="loop.html#cb311-31"></a><span class="co">## [[5]]</span></span>
<span id="cb311-32"><a href="loop.html#cb311-32"></a><span class="co">## [1] 0.2095848</span></span>
<span id="cb311-33"><a href="loop.html#cb311-33"></a>st_devs &lt;-<span class="st"> </span><span class="kw">lapply</span>(list_vec, sd)</span>
<span id="cb311-34"><a href="loop.html#cb311-34"></a>st_devs</span>
<span id="cb311-35"><a href="loop.html#cb311-35"></a><span class="co">## [[1]]</span></span>
<span id="cb311-36"><a href="loop.html#cb311-36"></a><span class="co">## [1] 1.028626</span></span>
<span id="cb311-37"><a href="loop.html#cb311-37"></a><span class="co">## </span></span>
<span id="cb311-38"><a href="loop.html#cb311-38"></a><span class="co">## [[2]]</span></span>
<span id="cb311-39"><a href="loop.html#cb311-39"></a><span class="co">## [1] 1.056527</span></span>
<span id="cb311-40"><a href="loop.html#cb311-40"></a><span class="co">## </span></span>
<span id="cb311-41"><a href="loop.html#cb311-41"></a><span class="co">## [[3]]</span></span>
<span id="cb311-42"><a href="loop.html#cb311-42"></a><span class="co">## [1] 1.027976</span></span>
<span id="cb311-43"><a href="loop.html#cb311-43"></a><span class="co">## </span></span>
<span id="cb311-44"><a href="loop.html#cb311-44"></a><span class="co">## [[4]]</span></span>
<span id="cb311-45"><a href="loop.html#cb311-45"></a><span class="co">## [1] 0.9351077</span></span>
<span id="cb311-46"><a href="loop.html#cb311-46"></a><span class="co">## </span></span>
<span id="cb311-47"><a href="loop.html#cb311-47"></a><span class="co">## [[5]]</span></span>
<span id="cb311-48"><a href="loop.html#cb311-48"></a><span class="co">## [1] 1.04055</span></span></code></pre></div>
<p>Come vedete il codice diventa estremamente compatto, pulito e facile da leggere.</p>
<div id="quali-funzioni-applicare" class="section level3">
<h3><span class="header-section-number">14.3.1</span> Quali funzioni applicare?</h3>
<p>Prima di descrivere nel dettaglio ogni funzione <code>*apply</code> è importante capire quali tipi di funzioni possiamo usare all’interno di questa famiglia. In generale, qualsiasi funzione può essere applicata ma per comodità possiamo distinguerle in:</p>
<ul>
<li>funzioni già presenti in R</li>
<li>funzioni personalizzate (create e salvate nell’ambiente principale)</li>
<li>funzioni <strong>anonime</strong></li>
</ul>
<p>Nell’esempio precedente, abbiamo utilizzato la funzione <code>mean</code> semplicemente scrivendo <code>lapply(lista, mean)</code>. Questo è possibile perchè <code>mean</code> necessita di un solo argomento. Se tuttavia volessimo applicare funzioni più complesse o aggiungere argomenti possiamo usare la scrittura più generale:</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="loop.html#cb312-1"></a>means &lt;-<span class="st"> </span><span class="kw">lapply</span>(list_vec, <span class="cf">function</span>(x) <span class="kw">mean</span>(x))</span>
<span id="cb312-2"><a href="loop.html#cb312-2"></a>means</span>
<span id="cb312-3"><a href="loop.html#cb312-3"></a><span class="co">## [[1]]</span></span>
<span id="cb312-4"><a href="loop.html#cb312-4"></a><span class="co">## [1] -0.1744844</span></span>
<span id="cb312-5"><a href="loop.html#cb312-5"></a><span class="co">## </span></span>
<span id="cb312-6"><a href="loop.html#cb312-6"></a><span class="co">## [[2]]</span></span>
<span id="cb312-7"><a href="loop.html#cb312-7"></a><span class="co">## [1] -0.001581971</span></span>
<span id="cb312-8"><a href="loop.html#cb312-8"></a><span class="co">## </span></span>
<span id="cb312-9"><a href="loop.html#cb312-9"></a><span class="co">## [[3]]</span></span>
<span id="cb312-10"><a href="loop.html#cb312-10"></a><span class="co">## [1] 0.003746107</span></span>
<span id="cb312-11"><a href="loop.html#cb312-11"></a><span class="co">## </span></span>
<span id="cb312-12"><a href="loop.html#cb312-12"></a><span class="co">## [[4]]</span></span>
<span id="cb312-13"><a href="loop.html#cb312-13"></a><span class="co">## [1] -0.1040844</span></span>
<span id="cb312-14"><a href="loop.html#cb312-14"></a><span class="co">## </span></span>
<span id="cb312-15"><a href="loop.html#cb312-15"></a><span class="co">## [[5]]</span></span>
<span id="cb312-16"><a href="loop.html#cb312-16"></a><span class="co">## [1] 0.2978849</span></span></code></pre></div>
<p>L’unica differenza è che abbiamo definito una funzione <strong>anonima</strong> con la scrittura <code>function(x) ...</code>. Questa scrittura si interpreta come “ogni elemento di <code>list_vec</code> diventa <code>x</code>, quindi applica la funzione <code>mean()</code> per ogni elemento di <code>list_vec</code>”. La funzione anonima permette di scrivere delle funzioni non salvate o presenti in R e applicare direttamente ad una serie di elementi. Possiamo anche usare funzioni più complesse come centrare ogni elemento di <code>list_vec</code>:</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="loop.html#cb313-1"></a>centered_list &lt;-<span class="st"> </span><span class="kw">lapply</span>(list_vec, <span class="cf">function</span>(x) x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x))</span>
<span id="cb313-2"><a href="loop.html#cb313-2"></a>centered_list</span>
<span id="cb313-3"><a href="loop.html#cb313-3"></a><span class="co">## [[1]]</span></span>
<span id="cb313-4"><a href="loop.html#cb313-4"></a><span class="co">##   [1]  0.052024420  0.726941033  0.523133907  0.534116649  1.072538094</span></span>
<span id="cb313-5"><a href="loop.html#cb313-5"></a><span class="co">##   [6] -1.748085116  0.436228769  1.090050776  0.188256343  1.904447568</span></span>
<span id="cb313-6"><a href="loop.html#cb313-6"></a><span class="co">##  [11] -0.907720449 -0.098340775  0.356479804  1.683026192  1.778954510</span></span>
<span id="cb313-7"><a href="loop.html#cb313-7"></a><span class="co">##  [16] -1.666991209  1.797794611  0.305873422  1.655606875  1.687802692</span></span>
<span id="cb313-8"><a href="loop.html#cb313-8"></a><span class="co">##  [21] -0.767958869 -0.011200606 -0.926640234  1.382599658 -1.450454139</span></span>
<span id="cb313-9"><a href="loop.html#cb313-9"></a><span class="co">##  [26]  0.279862739 -1.280958942 -0.179531732  0.080784364  1.275153032</span></span>
<span id="cb313-10"><a href="loop.html#cb313-10"></a><span class="co">##  [31] -1.789340704 -1.273459981  1.193927825 -1.246932674 -0.430047712</span></span>
<span id="cb313-11"><a href="loop.html#cb313-11"></a><span class="co">##  [36] -1.408989494 -1.111447945 -1.280200478  0.087413286  0.679220848</span></span>
<span id="cb313-12"><a href="loop.html#cb313-12"></a><span class="co">##  [41]  0.290873113  1.934698137 -0.170632058  2.294484562  0.140106914</span></span>
<span id="cb313-13"><a href="loop.html#cb313-13"></a><span class="co">##  [46] -0.617669647  1.649999618 -0.551072804  0.486863447  0.866448514</span></span>
<span id="cb313-14"><a href="loop.html#cb313-14"></a><span class="co">##  [51] -0.325806393 -2.081384947  0.218225732 -0.194333682 -0.785738000</span></span>
<span id="cb313-15"><a href="loop.html#cb313-15"></a><span class="co">##  [56]  0.278250713  0.601773540  0.004002865 -1.374655893 -1.331115539</span></span>
<span id="cb313-16"><a href="loop.html#cb313-16"></a><span class="co">##  [61]  0.190527940 -0.010879909  0.566417661 -0.582226517  0.405902013</span></span>
<span id="cb313-17"><a href="loop.html#cb313-17"></a><span class="co">##  [66] -0.809129005  0.739565224  1.791236297 -0.077479735 -0.881394205</span></span>
<span id="cb313-18"><a href="loop.html#cb313-18"></a><span class="co">##  [71] -0.173747353  0.131494431 -1.223069551  1.664700735 -0.864902716</span></span>
<span id="cb313-19"><a href="loop.html#cb313-19"></a><span class="co">##  [76] -0.062460642 -0.824657046 -1.218058185  1.156489655  0.535425340</span></span>
<span id="cb313-20"><a href="loop.html#cb313-20"></a><span class="co">##  [81] -0.163024811 -0.468903190 -1.992400872  0.807773400  0.029570256</span></span>
<span id="cb313-21"><a href="loop.html#cb313-21"></a><span class="co">##  [86] -1.065542698  0.708443728 -1.413780392 -0.816480128  0.657745237</span></span>
<span id="cb313-22"><a href="loop.html#cb313-22"></a><span class="co">##  [91]  0.985102777 -0.119180161  0.121026086  0.909668900  0.189469398</span></span>
<span id="cb313-23"><a href="loop.html#cb313-23"></a><span class="co">##  [96]  0.052482555 -0.472289289 -0.693373923 -0.334215899 -1.903099951</span></span>
<span id="cb313-24"><a href="loop.html#cb313-24"></a><span class="co">## </span></span>
<span id="cb313-25"><a href="loop.html#cb313-25"></a><span class="co">## [[2]]</span></span>
<span id="cb313-26"><a href="loop.html#cb313-26"></a><span class="co">##   [1] -0.25875450  0.45192195 -0.14129965 -0.48513950 -1.19419119  0.04852296</span></span>
<span id="cb313-27"><a href="loop.html#cb313-27"></a><span class="co">##   [7] -0.12494971 -2.69913307 -0.56923136  0.59317969  0.48855867 -0.12521792</span></span>
<span id="cb313-28"><a href="loop.html#cb313-28"></a><span class="co">##  [13] -1.25761789  0.20287395 -1.91532248  1.67432109  0.47237159  1.41569682</span></span>
<span id="cb313-29"><a href="loop.html#cb313-29"></a><span class="co">##  [19]  0.08588055 -1.80072157  0.75532561 -0.31036112 -1.73097833 -2.13698056</span></span>
<span id="cb313-30"><a href="loop.html#cb313-30"></a><span class="co">##  [25]  2.36738038  0.48633857  1.09481961  0.30449038  1.01688141  2.45517490</span></span>
<span id="cb313-31"><a href="loop.html#cb313-31"></a><span class="co">##  [31] -0.24403885  0.54310131  0.19845858 -2.06958035  0.51416551 -0.40417991</span></span>
<span id="cb313-32"><a href="loop.html#cb313-32"></a><span class="co">##  [37]  0.35777998 -0.32998890  0.08217311 -0.25995052 -0.87586827  0.74289078</span></span>
<span id="cb313-33"><a href="loop.html#cb313-33"></a><span class="co">##  [43] -2.68138122 -0.94789651  0.44784397 -1.28724749 -0.15622349  0.34939757</span></span>
<span id="cb313-34"><a href="loop.html#cb313-34"></a><span class="co">##  [49] -0.05804050  1.47831075 -0.65258270 -0.25523286 -1.25245596  0.77262514</span></span>
<span id="cb313-35"><a href="loop.html#cb313-35"></a><span class="co">##  [55] -0.90976997 -0.69172340 -0.61608640  0.76370516 -1.08557639 -0.39821755</span></span>
<span id="cb313-36"><a href="loop.html#cb313-36"></a><span class="co">##  [61]  0.82937843  0.35700165  0.16072076  0.95697716 -0.33806032 -0.72579950</span></span>
<span id="cb313-37"><a href="loop.html#cb313-37"></a><span class="co">##  [67] -1.69622426  1.95572036  2.66831987  2.06496139  0.82036535 -0.07806814</span></span>
<span id="cb313-38"><a href="loop.html#cb313-38"></a><span class="co">##  [73] -0.48786746  0.84930072 -0.95746280  0.93026931  0.38254698  1.49618576</span></span>
<span id="cb313-39"><a href="loop.html#cb313-39"></a><span class="co">##  [79] -0.46612240  0.26273926 -0.99102667 -1.06179903  0.27586663  0.94692452</span></span>
<span id="cb313-40"><a href="loop.html#cb313-40"></a><span class="co">##  [85]  0.72777105 -0.25293070  1.48676214  0.23186813  0.27958462  0.14862272</span></span>
<span id="cb313-41"><a href="loop.html#cb313-41"></a><span class="co">##  [91] -1.19470741  0.09171824  1.22085175 -0.55991059  0.33846373 -1.53521819</span></span>
<span id="cb313-42"><a href="loop.html#cb313-42"></a><span class="co">##  [97] -0.23854774  0.51644745 -0.23727325  0.58340054</span></span>
<span id="cb313-43"><a href="loop.html#cb313-43"></a><span class="co">## </span></span>
<span id="cb313-44"><a href="loop.html#cb313-44"></a><span class="co">## [[3]]</span></span>
<span id="cb313-45"><a href="loop.html#cb313-45"></a><span class="co">##   [1]  0.2664491638 -1.3469963272 -0.8526350420 -0.4113540385 -0.6698965617</span></span>
<span id="cb313-46"><a href="loop.html#cb313-46"></a><span class="co">##   [6] -0.1069834877 -0.9277972315  0.4348533514 -0.0158461161 -0.6496568470</span></span>
<span id="cb313-47"><a href="loop.html#cb313-47"></a><span class="co">##  [11]  1.3404006827  0.3308553677 -0.0008524137  1.0932070221  1.1595245506</span></span>
<span id="cb313-48"><a href="loop.html#cb313-48"></a><span class="co">##  [16]  0.0970402348 -0.3954985959 -0.4148154462 -0.9173273893 -0.5441391984</span></span>
<span id="cb313-49"><a href="loop.html#cb313-49"></a><span class="co">##  [21]  0.1176161927  1.7239915983 -0.0479376631  0.5410962859  1.9136056395</span></span>
<span id="cb313-50"><a href="loop.html#cb313-50"></a><span class="co">##  [26] -0.2403162233  1.5678772409  0.4771039676  0.0388510442  0.4360775197</span></span>
<span id="cb313-51"><a href="loop.html#cb313-51"></a><span class="co">##  [31] -1.8843109374 -1.7278160519  1.8794222142 -0.0350334621  0.9952978517</span></span>
<span id="cb313-52"><a href="loop.html#cb313-52"></a><span class="co">##  [36]  0.2965731726 -0.0089397169 -0.2440504016 -1.7747293817 -0.1599453739</span></span>
<span id="cb313-53"><a href="loop.html#cb313-53"></a><span class="co">##  [41]  1.9116204426  1.1063735070 -1.9894549474  0.8106197600  1.0945052782</span></span>
<span id="cb313-54"><a href="loop.html#cb313-54"></a><span class="co">##  [46] -1.4444401450  1.2114915468 -0.7866311249 -2.0708321586  0.3306083127</span></span>
<span id="cb313-55"><a href="loop.html#cb313-55"></a><span class="co">##  [51]  0.2571921978 -0.4380882424 -1.8767536475 -0.8067906332  0.3285759849</span></span>
<span id="cb313-56"><a href="loop.html#cb313-56"></a><span class="co">##  [56]  0.0083665339  0.8463602573 -1.5346139219 -0.0353043768  1.4238938000</span></span>
<span id="cb313-57"><a href="loop.html#cb313-57"></a><span class="co">##  [61] -0.9307764997  1.0018625824 -0.0897035610  0.9342787542 -0.5220418242</span></span>
<span id="cb313-58"><a href="loop.html#cb313-58"></a><span class="co">##  [66] -0.9382625616  1.2278393538 -0.2433379966  0.2694431409  1.4270790033</span></span>
<span id="cb313-59"><a href="loop.html#cb313-59"></a><span class="co">##  [71] -1.1447635626  0.8922605510  0.0790918016  0.3463267640 -1.2620371186</span></span>
<span id="cb313-60"><a href="loop.html#cb313-60"></a><span class="co">##  [76]  0.8359400483 -1.2621666167  0.1493675938 -0.4874471285  2.2071080499</span></span>
<span id="cb313-61"><a href="loop.html#cb313-61"></a><span class="co">##  [81]  0.0770783378  0.7123603570  1.0507096270  0.2724235769 -0.4240092719</span></span>
<span id="cb313-62"><a href="loop.html#cb313-62"></a><span class="co">##  [86]  2.5187562528 -0.0017295860 -1.5659889251 -1.9915300574 -1.4957999457</span></span>
<span id="cb313-63"><a href="loop.html#cb313-63"></a><span class="co">##  [91]  0.2514953082 -0.8182432673  0.8301238234 -1.1562445178 -0.1441958015</span></span>
<span id="cb313-64"><a href="loop.html#cb313-64"></a><span class="co">##  [96]  1.1723315781  0.1831991812 -0.6985203200 -0.4631891217 -0.4787516183</span></span>
<span id="cb313-65"><a href="loop.html#cb313-65"></a><span class="co">## </span></span>
<span id="cb313-66"><a href="loop.html#cb313-66"></a><span class="co">## [[4]]</span></span>
<span id="cb313-67"><a href="loop.html#cb313-67"></a><span class="co">##   [1]  1.31014158  1.09819466  1.64324210  0.39593137  0.61463274 -0.43683054</span></span>
<span id="cb313-68"><a href="loop.html#cb313-68"></a><span class="co">##   [7] -0.56982943  0.78423560  0.29079922 -1.28144712 -0.95320981  0.47832305</span></span>
<span id="cb313-69"><a href="loop.html#cb313-69"></a><span class="co">##  [13] -0.89843251  0.06142016  0.09834140 -0.93750994 -0.22114701 -0.50447853</span></span>
<span id="cb313-70"><a href="loop.html#cb313-70"></a><span class="co">##  [19]  1.62135004  0.40054994  0.50377989  0.85258426  0.01601205 -0.98150469</span></span>
<span id="cb313-71"><a href="loop.html#cb313-71"></a><span class="co">##  [25]  0.01879710  0.56958632  0.10405552  0.72039850 -0.54796577  0.55132606</span></span>
<span id="cb313-72"><a href="loop.html#cb313-72"></a><span class="co">##  [31] -0.07849753 -0.70235630 -1.70546632 -0.67537030 -1.88424294  1.10131999</span></span>
<span id="cb313-73"><a href="loop.html#cb313-73"></a><span class="co">##  [37] -0.93803709  0.30884776  0.38639004  0.26406936 -1.48220109  0.64941069</span></span>
<span id="cb313-74"><a href="loop.html#cb313-74"></a><span class="co">##  [43] -1.26245228 -1.01196361  0.26655677  1.61573387 -0.24499703 -1.86615753</span></span>
<span id="cb313-75"><a href="loop.html#cb313-75"></a><span class="co">##  [49] -0.74331502 -1.66625739  1.19375590 -1.29834857  1.03931548  0.09209179</span></span>
<span id="cb313-76"><a href="loop.html#cb313-76"></a><span class="co">##  [55]  0.36417167  1.25497932  1.27163836 -1.08423536  0.32463046  1.23838613</span></span>
<span id="cb313-77"><a href="loop.html#cb313-77"></a><span class="co">##  [61]  0.61505477 -1.39306979 -1.01347083 -0.65377057 -0.67234873 -0.15951329</span></span>
<span id="cb313-78"><a href="loop.html#cb313-78"></a><span class="co">##  [67] -1.09475421 -1.24828431  0.44936851 -0.81031734  0.48577901 -0.44783374</span></span>
<span id="cb313-79"><a href="loop.html#cb313-79"></a><span class="co">##  [73]  0.13878656 -0.42861642  1.05753379  0.80005894 -0.56816795  1.42707901</span></span>
<span id="cb313-80"><a href="loop.html#cb313-80"></a><span class="co">##  [79] -0.24334500 -0.42674961  0.83810754  0.25860309  0.76271285 -0.83189895</span></span>
<span id="cb313-81"><a href="loop.html#cb313-81"></a><span class="co">##  [85] -1.83769866  0.13777046 -0.34121388  1.28152635  0.02692627  0.65523055</span></span>
<span id="cb313-82"><a href="loop.html#cb313-82"></a><span class="co">##  [91] -0.34789338 -1.27102060  0.10899483  1.00604579 -0.82845156  0.66493483</span></span>
<span id="cb313-83"><a href="loop.html#cb313-83"></a><span class="co">##  [97]  0.41550756  1.49611518  2.54392757 -0.08039012</span></span>
<span id="cb313-84"><a href="loop.html#cb313-84"></a><span class="co">## </span></span>
<span id="cb313-85"><a href="loop.html#cb313-85"></a><span class="co">## [[5]]</span></span>
<span id="cb313-86"><a href="loop.html#cb313-86"></a><span class="co">##   [1] -0.97244116 -0.05975831  0.24720098 -0.74673643  0.67336181 -1.84504878</span></span>
<span id="cb313-87"><a href="loop.html#cb313-87"></a><span class="co">##   [7] -0.10088763  0.54085362  0.19802171 -0.21846188 -1.35504038 -1.00568442</span></span>
<span id="cb313-88"><a href="loop.html#cb313-88"></a><span class="co">##  [13] -1.66143029  0.32770743 -0.87494585  1.42240563  1.33871389 -0.49724504</span></span>
<span id="cb313-89"><a href="loop.html#cb313-89"></a><span class="co">##  [19]  0.23183020 -1.28236562  0.94682403  0.15097940 -0.08996773 -1.87922549</span></span>
<span id="cb313-90"><a href="loop.html#cb313-90"></a><span class="co">##  [25]  0.56434072  1.01141751  0.59054641  0.90708246  1.81054234  1.52125463</span></span>
<span id="cb313-91"><a href="loop.html#cb313-91"></a><span class="co">##  [31]  1.59879629  0.65703478 -1.36100263  1.52636999 -0.67568978  1.18846185</span></span>
<span id="cb313-92"><a href="loop.html#cb313-92"></a><span class="co">##  [37] -0.71371197 -0.62705645 -0.34696123  1.81946720 -0.14410534  0.77391802</span></span>
<span id="cb313-93"><a href="loop.html#cb313-93"></a><span class="co">##  [43] -1.40734286 -0.22652747 -0.08663243  0.24917797  0.10482833  0.40064474</span></span>
<span id="cb313-94"><a href="loop.html#cb313-94"></a><span class="co">##  [49] -0.11465530  1.67669566  0.89489601 -1.18726409 -0.69802085 -0.34089280</span></span>
<span id="cb313-95"><a href="loop.html#cb313-95"></a><span class="co">##  [55] -0.31607492 -1.19132141 -1.34752712  0.06417591  0.57868314  1.93393514</span></span>
<span id="cb313-96"><a href="loop.html#cb313-96"></a><span class="co">##  [61]  1.29099212  0.28454888 -1.05159708 -0.12011029 -1.39846790 -0.34956404</span></span>
<span id="cb313-97"><a href="loop.html#cb313-97"></a><span class="co">##  [67]  1.15216589  0.47442520  0.42866114  1.24934339 -0.17264100 -0.18756486</span></span>
<span id="cb313-98"><a href="loop.html#cb313-98"></a><span class="co">##  [73]  1.52868692 -0.50630793 -0.52108509 -2.27123722  0.10655986 -1.07339635</span></span>
<span id="cb313-99"><a href="loop.html#cb313-99"></a><span class="co">##  [79] -0.53370249  1.60949570 -0.08346146 -1.11549234 -1.60046934 -0.70496768</span></span>
<span id="cb313-100"><a href="loop.html#cb313-100"></a><span class="co">##  [85]  2.72371679 -0.15590380 -1.05128938  0.86727635  0.28486870 -1.34945579</span></span>
<span id="cb313-101"><a href="loop.html#cb313-101"></a><span class="co">##  [91] -0.81570377 -1.37540652  0.69447464 -0.31187353 -2.04954616  0.56538309</span></span>
<span id="cb313-102"><a href="loop.html#cb313-102"></a><span class="co">##  [97]  0.55236386  1.42950364  1.15527183 -0.17463612</span></span></code></pre></div>
<p>In questo caso, è chiaro che <code>x</code> è un placeholder che assume il valore di ogni elemento della lista <code>list_vec</code>.</p>
<p>L’uso di funzioni anonime è estremamente utile e chiaro una volta compresa la notazione. Tuttavia per funzioni più complesse è più conveniente scrivere salvare la funzione in un oggetto e poi applicarla come per <code>mean</code>. Usando sempre l’esempio di centrare la variabile possiamo:</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="loop.html#cb314-1"></a>center_vec &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb314-2"><a href="loop.html#cb314-2"></a>  <span class="kw">return</span>(x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x))</span>
<span id="cb314-3"><a href="loop.html#cb314-3"></a>}</span>
<span id="cb314-4"><a href="loop.html#cb314-4"></a></span>
<span id="cb314-5"><a href="loop.html#cb314-5"></a>centered_list &lt;-<span class="st"> </span><span class="kw">lapply</span>(list_vec, center_vec)</span></code></pre></div>
<p>Possiamo comunque applicare funzioni complesse come <strong>anonime</strong> semplicemente utilizzando le parentesi graffe proprio come se dovessimo dichiarare una funzione:</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="loop.html#cb315-1"></a>center_vec &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb315-2"><a href="loop.html#cb315-2"></a>  <span class="kw">return</span>(x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x))</span>
<span id="cb315-3"><a href="loop.html#cb315-3"></a>}</span>
<span id="cb315-4"><a href="loop.html#cb315-4"></a></span>
<span id="cb315-5"><a href="loop.html#cb315-5"></a>centered_list &lt;-<span class="st"> </span><span class="kw">lapply</span>(list_vec, <span class="cf">function</span>(x){</span>
<span id="cb315-6"><a href="loop.html#cb315-6"></a>  res &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb315-7"><a href="loop.html#cb315-7"></a>  <span class="kw">return</span>(res)</span>
<span id="cb315-8"><a href="loop.html#cb315-8"></a>})</span></code></pre></div>
<p>Un ultimo aspetto riguarda un parallismo tra <code>x</code> nei nostri esempi e <code>i</code>nei cicli <code>for</code> che abbiamo visto in precedenza. Proprio come <code>i</code>, <code>x</code> è una semplice convenzione e si può utilizzare qualsiasi nome per definire l’argomento generico. Inoltre, è utile pensare a <code>x</code> proprio con lo stesso ruolo di <code>i</code>, infatti se pensiamo alla funzione in precedenza, <code>x</code> ad ogni iterazione prende il valore di un elemento di <code>list_vec</code> proprio come utilizzare il ciclo <code>for</code> non con gli indici ma con i valori del vettore su cui stiamo iterando. Qualche volta infatti può essere utile applicare un principio di <strong>indicizzazione</strong> anche con l’ <code>*apply</code> family:</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="loop.html#cb316-1"></a>means &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">seq_along</span>(list_vec), <span class="cf">function</span>(i) <span class="kw">mean</span>(list_vec[[i]]))</span>
<span id="cb316-2"><a href="loop.html#cb316-2"></a>means</span>
<span id="cb316-3"><a href="loop.html#cb316-3"></a><span class="co">## [[1]]</span></span>
<span id="cb316-4"><a href="loop.html#cb316-4"></a><span class="co">## [1] -0.1744844</span></span>
<span id="cb316-5"><a href="loop.html#cb316-5"></a><span class="co">## </span></span>
<span id="cb316-6"><a href="loop.html#cb316-6"></a><span class="co">## [[2]]</span></span>
<span id="cb316-7"><a href="loop.html#cb316-7"></a><span class="co">## [1] -0.001581971</span></span>
<span id="cb316-8"><a href="loop.html#cb316-8"></a><span class="co">## </span></span>
<span id="cb316-9"><a href="loop.html#cb316-9"></a><span class="co">## [[3]]</span></span>
<span id="cb316-10"><a href="loop.html#cb316-10"></a><span class="co">## [1] 0.003746107</span></span>
<span id="cb316-11"><a href="loop.html#cb316-11"></a><span class="co">## </span></span>
<span id="cb316-12"><a href="loop.html#cb316-12"></a><span class="co">## [[4]]</span></span>
<span id="cb316-13"><a href="loop.html#cb316-13"></a><span class="co">## [1] -0.1040844</span></span>
<span id="cb316-14"><a href="loop.html#cb316-14"></a><span class="co">## </span></span>
<span id="cb316-15"><a href="loop.html#cb316-15"></a><span class="co">## [[5]]</span></span>
<span id="cb316-16"><a href="loop.html#cb316-16"></a><span class="co">## [1] 0.2978849</span></span></code></pre></div>
<p>In questo caso l’argomento non è più la lista ma un vettore di numeri da 1 alla lunghezza della lista (proprio come nel ciclo <code>for</code>). La funzione anonima poi prende come argomento <code>i</code> (che ricordiamo può essere qualsiasi nome) e utilizza <code>i</code> per indicizzare e applicare una funzione. In questo caso non è estremamente utile, ma con questa scrittura abbiamo riprodotto esattamente la logica del ciclo <code>for</code> in un modo estremamente compatto.</p>
</div>
<div id="apply" class="section level3">
<h3><span class="header-section-number">14.3.2</span> apply</h3>
<p>La funzione <code>apply</code> viene utilizzata su <strong>matrici</strong>, <strong>dataframe</strong> per applicare una funzione ad ogni dimensione (riga o colonna). La struttura della funzione è questa:</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="loop.html#cb317-1"></a><span class="kw">apply</span>(<span class="dt">X =</span> , <span class="dt">MARGIN =</span> , <span class="dt">FUN =</span> , ...)</span></code></pre></div>
<p>Dove:</p>
<ul>
<li><code>X</code> è il dataframe o la matrice</li>
<li><code>MARGIN</code> è la dimensione su cui applicare la funzione: <code>1</code> = riga e <code>2</code> = colonna</li>
<li><code>FUN</code> è la funzione da applicare</li>
</ul>
<div id="esempi" class="section level4 unnumbered">
<h4>Esempi</h4>
<ul>
<li>Semplici funzioni</li>
</ul>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="loop.html#cb318-1"></a>my_matrix &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">6</span>)</span>
<span id="cb318-2"><a href="loop.html#cb318-2"></a></span>
<span id="cb318-3"><a href="loop.html#cb318-3"></a><span class="co"># Per riga</span></span>
<span id="cb318-4"><a href="loop.html#cb318-4"></a><span class="kw">apply</span>(my_matrix, <span class="dt">MARGIN =</span> <span class="dv">1</span>, <span class="dt">FUN =</span> sum)</span>
<span id="cb318-5"><a href="loop.html#cb318-5"></a><span class="co">## [1] 66 72 78 84</span></span>
<span id="cb318-6"><a href="loop.html#cb318-6"></a></span>
<span id="cb318-7"><a href="loop.html#cb318-7"></a><span class="co"># Per colonna</span></span>
<span id="cb318-8"><a href="loop.html#cb318-8"></a><span class="kw">apply</span>(my_matrix, <span class="dt">MARGIN =</span> <span class="dv">2</span>, <span class="dt">FUN =</span> sum)</span>
<span id="cb318-9"><a href="loop.html#cb318-9"></a><span class="co">## [1] 10 26 42 58 74 90</span></span></code></pre></div>
<ul>
<li>Funzioni complesse</li>
</ul>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="loop.html#cb319-1"></a><span class="co"># Coefficiente di Variazione</span></span>
<span id="cb319-2"><a href="loop.html#cb319-2"></a><span class="kw">apply</span>(my_matrix, <span class="dt">MARGIN =</span> <span class="dv">2</span>, <span class="dt">FUN =</span> <span class="cf">function</span>(x){</span>
<span id="cb319-3"><a href="loop.html#cb319-3"></a>  mean &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb319-4"><a href="loop.html#cb319-4"></a>  sd &lt;-<span class="st"> </span><span class="kw">sd</span>(x)</span>
<span id="cb319-5"><a href="loop.html#cb319-5"></a>  </span>
<span id="cb319-6"><a href="loop.html#cb319-6"></a>  <span class="kw">return</span>(<span class="kw">round</span>(sd<span class="op">/</span>mean,<span class="dv">2</span>))</span>
<span id="cb319-7"><a href="loop.html#cb319-7"></a>})</span>
<span id="cb319-8"><a href="loop.html#cb319-8"></a><span class="co">## [1] 0.52 0.20 0.12 0.09 0.07 0.06</span></span></code></pre></div>
</div>
</div>
<div id="tapply" class="section level3">
<h3><span class="header-section-number">14.3.3</span> tapply</h3>
<p><code>tapply</code> è utile quando vogliamo applicare una funzione ad un elemento che viene <strong>diviso</strong> in base ad un’altra variabile. La scrittura è la seguente:</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="loop.html#cb320-1"></a><span class="kw">tapply</span>(<span class="dt">X =</span> , <span class="dt">INDEX =</span> , <span class="dt">FUN =</span> , ...)</span></code></pre></div>
<p>Dove:</p>
<ul>
<li><code>X</code> è la variabile principale</li>
<li><code>INDEX</code> è la variabile in base a cui suddividere <code>X</code></li>
<li><code>FUN</code> è la funzione da applicare</li>
</ul>
<div id="esempi-1" class="section level4 unnumbered">
<h4>Esempi</h4>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="loop.html#cb321-1"></a>my_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb321-2"><a href="loop.html#cb321-2"></a>  <span class="dt">y =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>), <span class="dt">size =</span> <span class="dv">32</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>),</span>
<span id="cb321-3"><a href="loop.html#cb321-3"></a>  <span class="dt">gender =</span> <span class="kw">factor</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>), <span class="dt">each =</span> <span class="dv">16</span>)),</span>
<span id="cb321-4"><a href="loop.html#cb321-4"></a>  <span class="dt">class =</span> <span class="kw">factor</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;3&quot;</span>, <span class="st">&quot;5&quot;</span>), <span class="dt">times =</span> <span class="dv">16</span>))</span>
<span id="cb321-5"><a href="loop.html#cb321-5"></a>)</span>
<span id="cb321-6"><a href="loop.html#cb321-6"></a></span>
<span id="cb321-7"><a href="loop.html#cb321-7"></a><span class="kw">head</span>(my_data, <span class="dt">n =</span> <span class="dv">4</span>)</span>
<span id="cb321-8"><a href="loop.html#cb321-8"></a><span class="co">##    y gender class</span></span>
<span id="cb321-9"><a href="loop.html#cb321-9"></a><span class="co">## 1  8      F     3</span></span>
<span id="cb321-10"><a href="loop.html#cb321-10"></a><span class="co">## 2 10      F     5</span></span>
<span id="cb321-11"><a href="loop.html#cb321-11"></a><span class="co">## 3  2      F     3</span></span>
<span id="cb321-12"><a href="loop.html#cb321-12"></a><span class="co">## 4  4      F     5</span></span>
<span id="cb321-13"><a href="loop.html#cb321-13"></a></span>
<span id="cb321-14"><a href="loop.html#cb321-14"></a><span class="co"># Media y per classe</span></span>
<span id="cb321-15"><a href="loop.html#cb321-15"></a><span class="kw">tapply</span>(my_data<span class="op">$</span>y, <span class="dt">INDEX =</span> my_data<span class="op">$</span>class, <span class="dt">FUN =</span> mean)</span>
<span id="cb321-16"><a href="loop.html#cb321-16"></a><span class="co">##     3     5 </span></span>
<span id="cb321-17"><a href="loop.html#cb321-17"></a><span class="co">## 5.875 6.625</span></span>
<span id="cb321-18"><a href="loop.html#cb321-18"></a></span>
<span id="cb321-19"><a href="loop.html#cb321-19"></a><span class="co"># Media y per classe e genere</span></span>
<span id="cb321-20"><a href="loop.html#cb321-20"></a><span class="kw">tapply</span>(my_data<span class="op">$</span>y, <span class="dt">INDEX =</span> <span class="kw">list</span>(my_data<span class="op">$</span>class, my_data<span class="op">$</span>gender), <span class="dt">FUN =</span> mean)</span>
<span id="cb321-21"><a href="loop.html#cb321-21"></a><span class="co">##      F    M</span></span>
<span id="cb321-22"><a href="loop.html#cb321-22"></a><span class="co">## 3 6.50 5.25</span></span>
<span id="cb321-23"><a href="loop.html#cb321-23"></a><span class="co">## 5 5.75 7.50</span></span></code></pre></div>
</div>
</div>
<div id="lapply" class="section level3">
<h3><span class="header-section-number">14.3.4</span> lapply</h3>
<p>E’ forse la funzione più utilizzata e generica. Viene applicata ad ogni tipo di dato che sia una lista di elementi o un vettore. La particolarità è quella di restituire sempre una lista come risultato, indipendentemente dal tipo di input. La scrittura è la seguente:</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="loop.html#cb322-1"></a><span class="kw">lapply</span>(<span class="dt">X =</span> , <span class="dt">FUN =</span> , ...)</span></code></pre></div>
<p>Dove:</p>
<ul>
<li><code>X</code> è il vettore o lista</li>
<li><code>FUN</code> è la funzione da applicare</li>
</ul>
<div id="esempi-2" class="section level4 unnumbered">
<h4>Esempi</h4>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="loop.html#cb323-1"></a>my_list &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb323-2"><a href="loop.html#cb323-2"></a>  <span class="dt">sample_norm =</span> <span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>),</span>
<span id="cb323-3"><a href="loop.html#cb323-3"></a>  <span class="dt">sample_unif =</span> <span class="kw">runif</span>(<span class="dv">15</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>),</span>
<span id="cb323-4"><a href="loop.html#cb323-4"></a>  <span class="dt">sample_pois =</span> <span class="kw">rpois</span>(<span class="dv">20</span>, <span class="dt">lambda =</span> <span class="dv">5</span>)</span>
<span id="cb323-5"><a href="loop.html#cb323-5"></a>)</span>
<span id="cb323-6"><a href="loop.html#cb323-6"></a></span>
<span id="cb323-7"><a href="loop.html#cb323-7"></a><span class="kw">str</span>(my_list)</span>
<span id="cb323-8"><a href="loop.html#cb323-8"></a><span class="co">## List of 3</span></span>
<span id="cb323-9"><a href="loop.html#cb323-9"></a><span class="co">##  $ sample_norm: num [1:10] 0.343 1.371 0.26 0.482 0.309 ...</span></span>
<span id="cb323-10"><a href="loop.html#cb323-10"></a><span class="co">##  $ sample_unif: num [1:15] 0.031 0.011 0.882 0.113 0.323 ...</span></span>
<span id="cb323-11"><a href="loop.html#cb323-11"></a><span class="co">##  $ sample_pois: int [1:20] 2 3 7 9 5 3 3 5 2 4 ...</span></span>
<span id="cb323-12"><a href="loop.html#cb323-12"></a></span>
<span id="cb323-13"><a href="loop.html#cb323-13"></a><span class="co"># Media </span></span>
<span id="cb323-14"><a href="loop.html#cb323-14"></a><span class="kw">lapply</span>(my_list, <span class="dt">FUN =</span> mean)</span>
<span id="cb323-15"><a href="loop.html#cb323-15"></a><span class="co">## $sample_norm</span></span>
<span id="cb323-16"><a href="loop.html#cb323-16"></a><span class="co">## [1] 0.5029392</span></span>
<span id="cb323-17"><a href="loop.html#cb323-17"></a><span class="co">## </span></span>
<span id="cb323-18"><a href="loop.html#cb323-18"></a><span class="co">## $sample_unif</span></span>
<span id="cb323-19"><a href="loop.html#cb323-19"></a><span class="co">## [1] 0.3935366</span></span>
<span id="cb323-20"><a href="loop.html#cb323-20"></a><span class="co">## </span></span>
<span id="cb323-21"><a href="loop.html#cb323-21"></a><span class="co">## $sample_pois</span></span>
<span id="cb323-22"><a href="loop.html#cb323-22"></a><span class="co">## [1] 4.25</span></span></code></pre></div>
</div>
</div>
<div id="sapply" class="section level3">
<h3><span class="header-section-number">14.3.5</span> sapply</h3>
<p><code>sapply</code> ha la stessa funzionalità di <code>lapply</code> ma ha anche la capacità di restituire una versione semplificata (se possibile) dell’output.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="loop.html#cb324-1"></a><span class="kw">sapply</span>(<span class="dt">X =</span> , <span class="dt">FUN =</span> , ... )</span></code></pre></div>
<div id="esempi-3" class="section level4 unnumbered">
<h4>Esempi</h4>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="loop.html#cb325-1"></a><span class="co"># Media </span></span>
<span id="cb325-2"><a href="loop.html#cb325-2"></a><span class="kw">sapply</span>(my_list, <span class="dt">FUN =</span> mean)</span>
<span id="cb325-3"><a href="loop.html#cb325-3"></a><span class="co">## sample_norm sample_unif sample_pois </span></span>
<span id="cb325-4"><a href="loop.html#cb325-4"></a><span class="co">##   0.5029392   0.3935366   4.2500000</span></span></code></pre></div>
<p>Per capire la differenza, applichiamo sia <code>lapply</code> che <code>sapply</code> con gli esempi precedenti:</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="loop.html#cb326-1"></a><span class="kw">sapply</span>(list_vec, mean)</span>
<span id="cb326-2"><a href="loop.html#cb326-2"></a><span class="co">## [1] -0.174484405 -0.001581971  0.003746107 -0.104084425  0.297884925</span></span>
<span id="cb326-3"><a href="loop.html#cb326-3"></a><span class="kw">lapply</span>(list_vec, mean)</span>
<span id="cb326-4"><a href="loop.html#cb326-4"></a><span class="co">## [[1]]</span></span>
<span id="cb326-5"><a href="loop.html#cb326-5"></a><span class="co">## [1] -0.1744844</span></span>
<span id="cb326-6"><a href="loop.html#cb326-6"></a><span class="co">## </span></span>
<span id="cb326-7"><a href="loop.html#cb326-7"></a><span class="co">## [[2]]</span></span>
<span id="cb326-8"><a href="loop.html#cb326-8"></a><span class="co">## [1] -0.001581971</span></span>
<span id="cb326-9"><a href="loop.html#cb326-9"></a><span class="co">## </span></span>
<span id="cb326-10"><a href="loop.html#cb326-10"></a><span class="co">## [[3]]</span></span>
<span id="cb326-11"><a href="loop.html#cb326-11"></a><span class="co">## [1] 0.003746107</span></span>
<span id="cb326-12"><a href="loop.html#cb326-12"></a><span class="co">## </span></span>
<span id="cb326-13"><a href="loop.html#cb326-13"></a><span class="co">## [[4]]</span></span>
<span id="cb326-14"><a href="loop.html#cb326-14"></a><span class="co">## [1] -0.1040844</span></span>
<span id="cb326-15"><a href="loop.html#cb326-15"></a><span class="co">## </span></span>
<span id="cb326-16"><a href="loop.html#cb326-16"></a><span class="co">## [[5]]</span></span>
<span id="cb326-17"><a href="loop.html#cb326-17"></a><span class="co">## [1] 0.2978849</span></span>
<span id="cb326-18"><a href="loop.html#cb326-18"></a><span class="kw">sapply</span>(list_vec, mean, <span class="dt">simplify =</span> <span class="ot">FALSE</span>)</span>
<span id="cb326-19"><a href="loop.html#cb326-19"></a><span class="co">## [[1]]</span></span>
<span id="cb326-20"><a href="loop.html#cb326-20"></a><span class="co">## [1] -0.1744844</span></span>
<span id="cb326-21"><a href="loop.html#cb326-21"></a><span class="co">## </span></span>
<span id="cb326-22"><a href="loop.html#cb326-22"></a><span class="co">## [[2]]</span></span>
<span id="cb326-23"><a href="loop.html#cb326-23"></a><span class="co">## [1] -0.001581971</span></span>
<span id="cb326-24"><a href="loop.html#cb326-24"></a><span class="co">## </span></span>
<span id="cb326-25"><a href="loop.html#cb326-25"></a><span class="co">## [[3]]</span></span>
<span id="cb326-26"><a href="loop.html#cb326-26"></a><span class="co">## [1] 0.003746107</span></span>
<span id="cb326-27"><a href="loop.html#cb326-27"></a><span class="co">## </span></span>
<span id="cb326-28"><a href="loop.html#cb326-28"></a><span class="co">## [[4]]</span></span>
<span id="cb326-29"><a href="loop.html#cb326-29"></a><span class="co">## [1] -0.1040844</span></span>
<span id="cb326-30"><a href="loop.html#cb326-30"></a><span class="co">## </span></span>
<span id="cb326-31"><a href="loop.html#cb326-31"></a><span class="co">## [[5]]</span></span>
<span id="cb326-32"><a href="loop.html#cb326-32"></a><span class="co">## [1] 0.2978849</span></span></code></pre></div>
<p>Come vedete, il risultato di queste operazioni corrisponde ad un valore per ogni elemento della lista <code>list_vec</code>. <code>lapply</code> restituisce una lista con i risultati mentre <code>sapply</code> resituisce un vettore. Nel caso di risultati singoli come in questa situazione, l’utilizzo di <code>sapply</code> è conveniente mentre mantenere la struttura a lista può essere meglio in altre condizioni. Possiamo comunque evitare che <code>sapply</code> semplifichi l’output usando l’argomento <code>simplify = FALSE</code>.</p>
</div>
</div>
<div id="vapply" class="section level3">
<h3><span class="header-section-number">14.3.6</span> vapply</h3>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="loop.html#cb327-1"></a><span class="kw">vapply</span>(<span class="dt">X =</span> , <span class="dt">FUN =</span> , <span class="dt">FUN.VALUE =</span>  ,... )</span></code></pre></div>
<div id="esempi-4" class="section level4 unnumbered">
<h4>Esempi</h4>
<p><code>vapply</code> è una ancora una volta simile sia a <code>lapply</code> che a <code>sapply</code>. Tuttavia richiede che il tipo di output sia specificato in anticipo. Per questo motivo è ritenuta una versione più <em>solida</em> delle precedenti perchè permette più controllo su quello che accade.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="loop.html#cb328-1"></a><span class="co"># Media </span></span>
<span id="cb328-2"><a href="loop.html#cb328-2"></a><span class="kw">vapply</span>(my_list, <span class="dt">FUN =</span> mean, <span class="dt">FUN.VALUE =</span> <span class="kw">numeric</span>(<span class="dt">length =</span> 1L))</span>
<span id="cb328-3"><a href="loop.html#cb328-3"></a><span class="co">## sample_norm sample_unif sample_pois </span></span>
<span id="cb328-4"><a href="loop.html#cb328-4"></a><span class="co">##   0.5029392   0.3935366   4.2500000</span></span></code></pre></div>
<p>In questo caso come in precendeza definiamo la lista su cui applicare la funzione. Tuttavia l’argomento <code>FUN.VALUE = numeric(length = 1L)</code> specifica che ogni risultato dovrà essere un valore di tipo <code>numeric</code> di lunghezza 1. Infatti applicando la media otteniamo un singolo valore per iterazione e questo valore è necessariamente numerico.</p>
<div class="warning" title="sapply() vs vapply()">
<p><code>sapply()</code> non restituisce sempre la stessa tipologia di oggetto mentre <code>vapply()</code> richiede sia specificato il tipo di l’output di ogni iterazione.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="loop.html#cb329-1"></a>x1 &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb329-2"><a href="loop.html#cb329-2"></a>  <span class="dt">sample_unif =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="kw">runif</span>(<span class="dv">15</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>)),</span>
<span id="cb329-3"><a href="loop.html#cb329-3"></a>  <span class="dt">sample_norm =</span> <span class="kw">rnorm</span>(<span class="dv">5</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>),</span>
<span id="cb329-4"><a href="loop.html#cb329-4"></a>  <span class="dt">sample_pois =</span> <span class="kw">rpois</span>(<span class="dv">20</span>, <span class="dt">lambda =</span> <span class="dv">5</span>)</span>
<span id="cb329-5"><a href="loop.html#cb329-5"></a>)</span>
<span id="cb329-6"><a href="loop.html#cb329-6"></a>x2 &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb329-7"><a href="loop.html#cb329-7"></a>  <span class="dt">sample_gamma =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="kw">rgamma</span>(<span class="dv">10</span>, <span class="dt">shape =</span> <span class="dv">1</span>)),</span>
<span id="cb329-8"><a href="loop.html#cb329-8"></a>  <span class="dt">sample_unif =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="kw">runif</span>(<span class="dv">15</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>)),</span>
<span id="cb329-9"><a href="loop.html#cb329-9"></a>  <span class="dt">sample_pois =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="kw">rpois</span>(<span class="dv">20</span>, <span class="dt">lambda =</span> <span class="dv">5</span>))</span>
<span id="cb329-10"><a href="loop.html#cb329-10"></a>)</span>
<span id="cb329-11"><a href="loop.html#cb329-11"></a></span>
<span id="cb329-12"><a href="loop.html#cb329-12"></a>negative_values &lt;-<span class="st"> </span><span class="cf">function</span>(x) x[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>]</span>
<span id="cb329-13"><a href="loop.html#cb329-13"></a><span class="kw">sapply</span>(x1, negative_values) </span>
<span id="cb329-14"><a href="loop.html#cb329-14"></a><span class="co">## $sample_unif</span></span>
<span id="cb329-15"><a href="loop.html#cb329-15"></a><span class="co">## [1] -1</span></span>
<span id="cb329-16"><a href="loop.html#cb329-16"></a><span class="co">## </span></span>
<span id="cb329-17"><a href="loop.html#cb329-17"></a><span class="co">## $sample_norm</span></span>
<span id="cb329-18"><a href="loop.html#cb329-18"></a><span class="co">## [1] -0.95907200 -0.08395547</span></span>
<span id="cb329-19"><a href="loop.html#cb329-19"></a><span class="co">## </span></span>
<span id="cb329-20"><a href="loop.html#cb329-20"></a><span class="co">## $sample_pois</span></span>
<span id="cb329-21"><a href="loop.html#cb329-21"></a><span class="co">## integer(0)</span></span>
<span id="cb329-22"><a href="loop.html#cb329-22"></a><span class="kw">sapply</span>(x2, negative_values) </span>
<span id="cb329-23"><a href="loop.html#cb329-23"></a><span class="co">## sample_gamma  sample_unif  sample_pois </span></span>
<span id="cb329-24"><a href="loop.html#cb329-24"></a><span class="co">##           -1           -2           -3</span></span>
<span id="cb329-25"><a href="loop.html#cb329-25"></a></span>
<span id="cb329-26"><a href="loop.html#cb329-26"></a><span class="kw">vapply</span>(x1, negative_values, <span class="dt">FUN.VALUE =</span> <span class="kw">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb329-27"><a href="loop.html#cb329-27"></a><span class="co">## Error in vapply(x1, negative_values, FUN.VALUE = numeric(1)): values must be length 1,</span></span>
<span id="cb329-28"><a href="loop.html#cb329-28"></a><span class="co">##  but FUN(X[[2]]) result is length 2</span></span>
<span id="cb329-29"><a href="loop.html#cb329-29"></a><span class="kw">vapply</span>(x2, negative_values, <span class="dt">FUN.VALUE =</span> <span class="kw">numeric</span>(<span class="dv">1</span>)) </span>
<span id="cb329-30"><a href="loop.html#cb329-30"></a><span class="co">## sample_gamma  sample_unif  sample_pois </span></span>
<span id="cb329-31"><a href="loop.html#cb329-31"></a><span class="co">##           -1           -2           -3</span></span></code></pre></div>
</div>
</div>
</div>
<div id="lista-di-funzioni-a-lista-di-oggetti" class="section level3">
<h3><span class="header-section-number">14.3.7</span> Lista di funzioni a lista di oggetti</h3>
<p>L’<code>*apply</code> family permette anche di estendere la formula “applica una funzione ad una lista di argomenti” applicando diverse funzioni inm modo estremamente compatto. Le funzioni infatti sono oggetti come altri in R e possono essere contenute in liste:</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="loop.html#cb330-1"></a>list_funs &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb330-2"><a href="loop.html#cb330-2"></a>  <span class="st">&quot;mean&quot;</span> =<span class="st"> </span>mean,</span>
<span id="cb330-3"><a href="loop.html#cb330-3"></a>  <span class="st">&quot;median&quot;</span> =<span class="st"> </span>median,</span>
<span id="cb330-4"><a href="loop.html#cb330-4"></a>  <span class="st">&quot;sd&quot;</span> =<span class="st"> </span>sd</span>
<span id="cb330-5"><a href="loop.html#cb330-5"></a>)</span>
<span id="cb330-6"><a href="loop.html#cb330-6"></a></span>
<span id="cb330-7"><a href="loop.html#cb330-7"></a><span class="kw">lapply</span>(list_funs, <span class="cf">function</span>(f) <span class="kw">sapply</span>(list_vec, <span class="cf">function</span>(x) <span class="kw">f</span>(x)))</span>
<span id="cb330-8"><a href="loop.html#cb330-8"></a><span class="co">## $mean</span></span>
<span id="cb330-9"><a href="loop.html#cb330-9"></a><span class="co">## [1] -0.174484405 -0.001581971  0.003746107 -0.104084425  0.297884925</span></span>
<span id="cb330-10"><a href="loop.html#cb330-10"></a><span class="co">## </span></span>
<span id="cb330-11"><a href="loop.html#cb330-11"></a><span class="co">## $median</span></span>
<span id="cb330-12"><a href="loop.html#cb330-12"></a><span class="co">## [1] -0.133687067  0.082444857  0.002455108 -0.008867830  0.209584846</span></span>
<span id="cb330-13"><a href="loop.html#cb330-13"></a><span class="co">## </span></span>
<span id="cb330-14"><a href="loop.html#cb330-14"></a><span class="co">## $sd</span></span>
<span id="cb330-15"><a href="loop.html#cb330-15"></a><span class="co">## [1] 1.0286259 1.0565268 1.0279756 0.9351077 1.0405497</span></span></code></pre></div>
<p>Quello che abbiamo fatto è creare una lista di funzioni e poi scrivere due <code>lapply</code> e <code>sapply</code> in modo <em>nested</em>. Proprio come quando scriviamo due <code>loop</code> nested, la stessa funzione viene applicata a tutti gli elementi, per poi passare alla funzione successiva. Il risultato infatti è una lista dove ogni elemento contiene i risultati applicando ogni funzione. Questo tipo di scrittura è più rara da trovare, tuttavia è utile per capire la logica e la potenza di questo approccio.</p>
<p>:::</p>
</div>
<div id="mapply" class="section level3">
<h3><span class="header-section-number">14.3.8</span> mapply</h3>
<p><code>mapply</code> è la versione più complessa di quelle considerate perchè estende a <em>n</em> il numero di liste che vogliamo utilizzare. La scrittura è la seguente:</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="loop.html#cb331-1"></a><span class="kw">mapply</span>(FUN, ...)</span></code></pre></div>
<p>Dove:</p>
<ul>
<li><code>FUN</code> è la funzione da applicare</li>
<li><code>...</code> sono le liste di elementi su cui applicare la funzione. E’ importante che tutti gli elementi siano della stessa lunghezza</li>
</ul>
<p>Proviamo a generare dei vettori da una distribuzione normale, usando la funzione <code>rnorm()</code> con diversi valori di numerosità, media e deviazione standard.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="loop.html#cb332-1"></a>ns &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb332-2"><a href="loop.html#cb332-2"></a>means &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>)</span>
<span id="cb332-3"><a href="loop.html#cb332-3"></a>sds &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">7</span>)</span>
<span id="cb332-4"><a href="loop.html#cb332-4"></a></span>
<span id="cb332-5"><a href="loop.html#cb332-5"></a><span class="kw">mapply</span>(<span class="cf">function</span>(x, y, z) <span class="kw">rnorm</span>(x, y, z), <span class="co"># funzione</span></span>
<span id="cb332-6"><a href="loop.html#cb332-6"></a>       ns, means, sds) <span class="co"># argomenti</span></span>
<span id="cb332-7"><a href="loop.html#cb332-7"></a><span class="co">## [[1]]</span></span>
<span id="cb332-8"><a href="loop.html#cb332-8"></a><span class="co">##  [1]  6.953099  6.854824  9.080728 11.687548  7.215676  7.706871 11.480102</span></span>
<span id="cb332-9"><a href="loop.html#cb332-9"></a><span class="co">##  [8]  7.142393  8.784290 13.292173</span></span>
<span id="cb332-10"><a href="loop.html#cb332-10"></a><span class="co">## </span></span>
<span id="cb332-11"><a href="loop.html#cb332-11"></a><span class="co">## [[2]]</span></span>
<span id="cb332-12"><a href="loop.html#cb332-12"></a><span class="co">## [1] 21.99553 14.81288 18.84860</span></span>
<span id="cb332-13"><a href="loop.html#cb332-13"></a><span class="co">## </span></span>
<span id="cb332-14"><a href="loop.html#cb332-14"></a><span class="co">## [[3]]</span></span>
<span id="cb332-15"><a href="loop.html#cb332-15"></a><span class="co">## [1] 33.26673 22.67479 26.38153 26.86117 25.80392</span></span></code></pre></div>
<p>La scrittura è sicuramente meno chiara rispetto agli esempi precedenti ma l’idea è la seguente:</p>
<ul>
<li>la funzione <strong>anonima</strong> non ha solo un argomento ma <em>n</em> argomenti</li>
<li>gli argomenti sono specificati in ordine, quindi nel nostro esempio <code>x = ns, y = means e z = sds</code></li>
<li>ogni iterazione, la funzione <code>rnorm</code> ottiene come argomenti una diversa numerosità, media e deviazione standard</li>
</ul>
</div>
</div>
<div id="replicate" class="section level2">
<h2><span class="header-section-number">14.4</span> Replicate</h2>
<p><code>replicate</code> è una funzione leggermente diversa ma estremamente utile. Permette di ripetere una serie di operazioni un numero prefissato di volte.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="loop.html#cb333-1"></a><span class="kw">replicate</span>(<span class="dt">n =</span> , <span class="dt">expr =</span> )</span></code></pre></div>
<p>Dove:</p>
<ul>
<li><code>n</code> è il numero di ripetizioni</li>
<li><code>expr</code> è il codice da ripetere</li>
</ul>
<div id="esempi-5" class="section level4 unnumbered">
<h4>Esempi</h4>
<ul>
<li>Semplice</li>
</ul>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="loop.html#cb334-1"></a>sample_info &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dt">n =</span> <span class="dv">1000</span>,{</span>
<span id="cb334-2"><a href="loop.html#cb334-2"></a>  my_sample &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb334-3"><a href="loop.html#cb334-3"></a>  my_mean &lt;-<span class="st"> </span><span class="kw">mean</span>(my_sample)</span>
<span id="cb334-4"><a href="loop.html#cb334-4"></a>  </span>
<span id="cb334-5"><a href="loop.html#cb334-5"></a>  <span class="kw">return</span>(my_mean)</span>
<span id="cb334-6"><a href="loop.html#cb334-6"></a>})</span>
<span id="cb334-7"><a href="loop.html#cb334-7"></a></span>
<span id="cb334-8"><a href="loop.html#cb334-8"></a><span class="kw">str</span>(sample_info)</span>
<span id="cb334-9"><a href="loop.html#cb334-9"></a><span class="co">##  num [1:1000] 0.395 -0.057 0.252 0.225 0.286 ...</span></span></code></pre></div>
<ul>
<li>Complesso</li>
</ul>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="loop.html#cb335-1"></a>sample_info &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dt">n =</span> <span class="dv">1000</span>,{</span>
<span id="cb335-2"><a href="loop.html#cb335-2"></a>  my_sample &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb335-3"><a href="loop.html#cb335-3"></a>  my_mean &lt;-<span class="st"> </span><span class="kw">mean</span>(my_sample)</span>
<span id="cb335-4"><a href="loop.html#cb335-4"></a>  my_sd &lt;-<span class="st"> </span><span class="kw">sd</span>(my_sample)</span>
<span id="cb335-5"><a href="loop.html#cb335-5"></a>  </span>
<span id="cb335-6"><a href="loop.html#cb335-6"></a>  <span class="kw">return</span>(<span class="kw">data.frame</span>(<span class="dt">mean =</span> my_mean, </span>
<span id="cb335-7"><a href="loop.html#cb335-7"></a>                    <span class="dt">sd =</span> my_sd))</span>
<span id="cb335-8"><a href="loop.html#cb335-8"></a>}, <span class="dt">simplify =</span> <span class="ot">FALSE</span>)</span>
<span id="cb335-9"><a href="loop.html#cb335-9"></a></span>
<span id="cb335-10"><a href="loop.html#cb335-10"></a></span>
<span id="cb335-11"><a href="loop.html#cb335-11"></a>sample_info &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>, sample_info)</span>
<span id="cb335-12"><a href="loop.html#cb335-12"></a></span>
<span id="cb335-13"><a href="loop.html#cb335-13"></a><span class="kw">str</span>(sample_info)</span>
<span id="cb335-14"><a href="loop.html#cb335-14"></a><span class="co">## &#39;data.frame&#39;:    1000 obs. of  2 variables:</span></span>
<span id="cb335-15"><a href="loop.html#cb335-15"></a><span class="co">##  $ mean: num  0.0966 -0.2776 0.1665 0.166 -0.1766 ...</span></span>
<span id="cb335-16"><a href="loop.html#cb335-16"></a><span class="co">##  $ sd  : num  1.093 1.059 1.105 1.109 0.954 ...</span></span>
<span id="cb335-17"><a href="loop.html#cb335-17"></a><span class="kw">head</span>(sample_info)</span>
<span id="cb335-18"><a href="loop.html#cb335-18"></a><span class="co">##          mean        sd</span></span>
<span id="cb335-19"><a href="loop.html#cb335-19"></a><span class="co">## 1  0.09660155 1.0926324</span></span>
<span id="cb335-20"><a href="loop.html#cb335-20"></a><span class="co">## 2 -0.27757342 1.0591981</span></span>
<span id="cb335-21"><a href="loop.html#cb335-21"></a><span class="co">## 3  0.16649003 1.1050091</span></span>
<span id="cb335-22"><a href="loop.html#cb335-22"></a><span class="co">## 4  0.16595363 1.1089836</span></span>
<span id="cb335-23"><a href="loop.html#cb335-23"></a><span class="co">## 5 -0.17656075 0.9537385</span></span>
<span id="cb335-24"><a href="loop.html#cb335-24"></a><span class="co">## 6 -0.18156384 0.9634895</span></span></code></pre></div>
<p>E’ importante sottolineare che la ripetizione è alla base di qualsiasi struttura iterativa che abbiamo visto finora. Infatti lo stesso risultato (al netto di leggibilità, velocità e versalità) lo possiamo ottenere indistintamente con un ciclo <code>for</code>, <code>lapply</code> o <code>replicate</code>. Riprendendo l’esempio precedente:</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="loop.html#cb336-1"></a></span>
<span id="cb336-2"><a href="loop.html#cb336-2"></a><span class="co"># Replicate</span></span>
<span id="cb336-3"><a href="loop.html#cb336-3"></a></span>
<span id="cb336-4"><a href="loop.html#cb336-4"></a>sample_info &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dt">n =</span> <span class="dv">1000</span>,{</span>
<span id="cb336-5"><a href="loop.html#cb336-5"></a>  my_sample &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb336-6"><a href="loop.html#cb336-6"></a>  my_mean &lt;-<span class="st"> </span><span class="kw">mean</span>(my_sample)</span>
<span id="cb336-7"><a href="loop.html#cb336-7"></a>  </span>
<span id="cb336-8"><a href="loop.html#cb336-8"></a>  <span class="kw">return</span>(my_mean)</span>
<span id="cb336-9"><a href="loop.html#cb336-9"></a>})</span>
<span id="cb336-10"><a href="loop.html#cb336-10"></a></span>
<span id="cb336-11"><a href="loop.html#cb336-11"></a><span class="kw">str</span>(sample_info)</span>
<span id="cb336-12"><a href="loop.html#cb336-12"></a><span class="co">##  num [1:1000] -0.109 -0.153 0.132 0.102 -0.202 ...</span></span>
<span id="cb336-13"><a href="loop.html#cb336-13"></a></span>
<span id="cb336-14"><a href="loop.html#cb336-14"></a><span class="co"># *apply</span></span>
<span id="cb336-15"><a href="loop.html#cb336-15"></a></span>
<span id="cb336-16"><a href="loop.html#cb336-16"></a>sample_info &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="cf">function</span>(x){</span>
<span id="cb336-17"><a href="loop.html#cb336-17"></a>  my_sample &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb336-18"><a href="loop.html#cb336-18"></a>  my_mean &lt;-<span class="st"> </span><span class="kw">mean</span>(my_sample)</span>
<span id="cb336-19"><a href="loop.html#cb336-19"></a>})</span>
<span id="cb336-20"><a href="loop.html#cb336-20"></a></span>
<span id="cb336-21"><a href="loop.html#cb336-21"></a><span class="kw">str</span>(sample_info)</span>
<span id="cb336-22"><a href="loop.html#cb336-22"></a><span class="co">##  num [1:1000] -0.0768 -0.1913 -0.0709 0.0338 0.0372 ...</span></span>
<span id="cb336-23"><a href="loop.html#cb336-23"></a></span>
<span id="cb336-24"><a href="loop.html#cb336-24"></a><span class="co"># for</span></span>
<span id="cb336-25"><a href="loop.html#cb336-25"></a></span>
<span id="cb336-26"><a href="loop.html#cb336-26"></a>sample_info &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode =</span> <span class="st">&quot;numeric&quot;</span>, <span class="dt">length =</span> <span class="dv">1000</span>)</span>
<span id="cb336-27"><a href="loop.html#cb336-27"></a></span>
<span id="cb336-28"><a href="loop.html#cb336-28"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){</span>
<span id="cb336-29"><a href="loop.html#cb336-29"></a>  my_sample &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb336-30"><a href="loop.html#cb336-30"></a>  sample_info[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(my_sample)</span>
<span id="cb336-31"><a href="loop.html#cb336-31"></a>}</span>
<span id="cb336-32"><a href="loop.html#cb336-32"></a></span>
<span id="cb336-33"><a href="loop.html#cb336-33"></a><span class="kw">str</span>(sample_info)</span>
<span id="cb336-34"><a href="loop.html#cb336-34"></a><span class="co">##  num [1:1000] -0.314 0.1203 0.1121 -0.1172 -0.0241 ...</span></span></code></pre></div>

</div>
</div>
</div>



<hr>
<center>
  <div class="footer">
    Questo libro è rilasciato in accordo con <a href= "https://creativecommons.org/licenses/by-sa/4.0/legalcode">CC BY-SA</a>.
    <br>
    Le illustrazioni utilizzate appartengono a <a href= "https://rstudio4edu.github.io/rstudio4edu-book/">rstudio4edu-book</a> in accordo con <a href= "https://creativecommons.org/licenses/by-nc/2.0/">CC BY-NC</a>.
    <br>
    Per conoscere di più riguardo <span style="color: #8C3031; font-weight:bold"> Psicostat</span> e le nostre attività, visita <a href= "https://psicostat.dpss.psy.unipd.it/">https://psicostat.dpss.psy.unipd.it/</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="conditionals.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduzione-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": true
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psicostat/Introduction2R/edit/master/17-loops.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Introduction2R.pdf", "Introduction2R.epub"],
"toc": {
"collapse": "section",
"scroll_highlight": true,
"toc_float": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
